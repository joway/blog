<!doctype html><html lang=en><meta charset=utf-8><meta name=generator content="Hugo 0.148.2"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Joway"><meta property="og:url" content="https://blog.joway.io/posts/how-animal-crossing-online-work/"><link rel=canonical href=https://blog.joway.io/posts/how-animal-crossing-online-work/><link rel=dns-prefetch href=https://cdn.jsdelivr.net/gh/joway/blog><link rel=apple-touch-icon href=/logo.png><link rel=icon href=/logo.png><link rel=shortcut href=/logo.png><link rel=alternate type=application/atom+xml href=https://blog.joway.io/index.xml title="Random Thoughts"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.joway.io\/"},"articleSection":"posts","name":"ä»åŠ¨ç‰©æ£®å‹ä¼šèŠä¸»æœºæ¸¸æˆè”æœºæœºåˆ¶","headline":"ä»åŠ¨ç‰©æ£®å‹ä¼šèŠä¸»æœºæ¸¸æˆè”æœºæœºåˆ¶","description":"æœ€è¿‘åœ¨ç©åŠ¨ç‰©æ£®å‹ä¼šçš„æ—¶å€™æ—¶å¸¸ä¼šé‡åˆ°ä¸€äº›è¿·ä¹‹è”æœºé—®é¢˜ï¼Œåœ¨ç½‘ä¸Šä¸€ç•ªæœç´¢ï¼Œå‘ç°å¤§å®¶çš„ç­”æ¡ˆéƒ½è¶‹äºç”¨ç„å­¦æ¥è§£é‡Šï¼Œäºæ˜¯ä¾¿æœ‰äº†å…´è‡´æƒ³åœ¨åŸç†ä¸Šææ‡‚è¿™äº›é—®é¢˜äº§ç”Ÿçš„æ ¹æºä»¥åŠåŠ¨æ£®è¿™æ¬¾æ¸¸æˆçš„ä¸€äº›è”æœºè®¾å®šèƒŒåçš„æŠ€æœ¯åŸå› ã€‚\näº‹å…ˆå£°æ˜ï¼Œæœ¬äººå¹¶ä¸ä»äº‹æ¸¸æˆè¡Œä¸šäº¦éä¸»æœºæ¸¸æˆé•¿æœŸç©å®¶ï¼Œå¦‚æœ‰çº°æ¼æˆ–å…¶ä»–è§’åº¦çš„è¡¥å……ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºå‘ŠçŸ¥ã€‚\næ¸¸æˆæ˜¯å¦‚ä½•åŒæ­¥çš„ æˆ‘ä»¬é¦–å…ˆæ¥çœ‹çœ‹ä¸€èˆ¬æ¸¸æˆæ˜¯å¦‚ä½•æ¥åšåŒæ­¥çš„ã€‚\næƒ³è±¡ä¸¤ä¸ªç‹¬ç«‹æˆ¿é—´é‡Œåˆ†åˆ«æœ‰ç”²ã€ä¹™ä¸¤ä¸ªç©å®¶ï¼Œä»–ä»¬è¦è¿œç¨‹ä¸‹ä¸€å±€è±¡æ£‹ã€‚ä»–ä»¬æ¯ä¸‹ä¸€æ­¥å‰éƒ½éœ€è¦å…ˆè·çŸ¥åˆ°å½“å‰æ£‹ç›˜çš„æƒ…å†µï¼Œæ­¤æ—¶èƒ½å¤Ÿæœ‰ä¸¤ç§å®ç°æ–¹å¼ã€‚\nç¬¬ä¸€ç§å«åšé”æ­¥åŒæ­¥ï¼ŒåŸç†æ˜¯ç©å®¶æ¯æ“ä½œä¸€æ­¥å°±é€šçŸ¥ç»™å¦å¤–ä¸€ä¸ªç©å®¶ï¼Œå½¼æ­¤åŒæ­¥å½“å‰çš„æ“ä½œåºåˆ—ï¼Œé€šè¿‡è¿™äº›æœ‰æ—¶åºçš„æ“ä½œï¼Œå°±èƒ½å¤Ÿè®¡ç®—å‡ºå½“å‰æ£‹å±€çš„çŠ¶æ€ã€‚ä½†å®ƒä¸å…è®¸ä¸­é—´ä¸¢å¤±ä»»ä½•ä¸€æ­¥çš„ä¿¡æ¯ï¼Œå¦åˆ™å°±ä¼šå‡ºç°éå¸¸å¤§çš„è®¡ç®—åå·®ã€‚\nç¬¬äºŒç§å«åšçŠ¶æ€åŒæ­¥ï¼Œé¡¾åæ€ä¹‰æ˜¯ç©å®¶æ¯æ“ä½œä¸€æ­¥ï¼Œå°±åŒæ­¥æ•´ä¸ªæ£‹ç›˜çš„çŠ¶æ€ã€‚è¿™ç§æ–¹å¼å¯ä»¥å®¹å¿ä¸­é—´æŸäº›çŠ¶æ€ä¸¢å¤±ï¼Œæœ€ç»ˆå¾—åˆ°çš„çŠ¶æ€ä¾æ—§è¿˜æ˜¯ä¸€è‡´çš„ã€‚\nåœ¨å®é™…å®è·µä¸­ï¼Œé’ˆå¯¹é‚£ç§ç©å®¶æ“ä½œéå¸¸é«˜é¢‘çš„æ¸¸æˆä¼šæ›´å¤šä½¿ç”¨é”æ­¥åŒæ­¥ï¼Œä¾‹å¦‚ç‹è€…è£è€€ã€‚è€Œå¯¹äºé‚£äº›å¡ç‰Œç±»æ¸¸æˆæ›´åå‘äºç›´æ¥ç”¨çŠ¶æ€åŒæ­¥ã€‚\næ¸¸æˆæ˜¯å¦‚ä½•è”æœºçš„ é€šä¿¡æ¶æ„ æ— è®ºæ˜¯ä¸Šè¿°å“ªç§åŒæ­¥æ–¹å¼ï¼Œæˆ‘ä»¬éƒ½éœ€è¦é€šè¿‡ç½‘ç»œåœ¨å¤šä¸ªä¸»æœºé—´äº¤æ¢æ•°æ®ã€‚æˆ‘ä»¬ç°åœ¨å°†åœºæ™¯è½¬æ¢æˆç”²ã€ä¹™ã€ä¸™ä¸‰ä¸ªäººä¸€èµ·ä¸‹è·³æ£‹ã€‚ä¸ºä¿è¯ä¸‰ä¸ªäººæœ€ç»ˆå¾—åˆ°çš„æ¸¸æˆçŠ¶æ€éƒ½æ˜¯ä¸€è‡´çš„ï¼Œæˆ‘ä»¬å¾€å¾€éœ€è¦æœ‰ä¸€å° Host ä¸»æœºæ¥ä½œä¸ºæƒå¨ä¸»æœºï¼Œå…¶ä»–ä¸»æœºåªèƒ½é€šè¿‡æƒå¨ä¸»æœºä¸‹å‘çš„æ•°æ®(çŠ¶æ€\/æ“ä½œåºåˆ—)æ¥æ›´æ–°è‡ªå·±æœ¬åœ°çš„æ¸¸æˆæ•°æ®ã€‚\nåœ¨è¿™é‡Œæˆ‘ä»¬å‡è®¾ç”²æ¥åšã€ŒHostã€ï¼Œä¹™ã€ä¸™æ¯æ“ä½œä¸€æ­¥ï¼Œéƒ½éœ€è¦å…ˆå‘é€ç»™ç”²ç¡®è®¤ï¼Œæ— è¯¯åå†å‘é€è¯¥æ“ä½œè¢«ç¡®è®¤çš„ä¿¡æ¯ç»™ä¹™ã€ä¸™ï¼Œä¹™ã€ä¸™æ­¤æ—¶æ‰èƒ½å¤Ÿè®¤ä¸ºæ“ä½œæˆåŠŸå¹¶å°†ç”»é¢æ›´æ–°åˆ°æœ€æ–°çš„çŠ¶æ€ã€‚ç”²ä¸»æœºä¸Šåœ¨ä»»æ„æ—¶åˆ»éƒ½å­˜æœ‰å½“å‰æ¸¸æˆçš„çœŸæ­£çŠ¶æ€ï¼Œå…¶ä»–ä¸»æœºåªæ˜¯åœ¨ follow ç”²ä¸»æœºçš„çŠ¶æ€ä»¥æ›´æ–°è‡ªå·±çš„æ¸¸æˆç”»é¢ã€‚\nåœ¨ä¸Šè¿°æ¨¡å¼ä¸‹ï¼Œç”±äºç”²ä¸»æœºæ—¢è¦ä½œä¸ºæ¸¸æˆä¸»æœºï¼Œåˆè¦ä½œä¸ºçŠ¶æ€åŒæ­¥çš„ä¸»æœºï¼Œå½“è”æœºç”¨æˆ·æ•°ä¸€å¤šï¼Œç”²ä¸»æœºå°±ä¼šä¸å ªé‡è´Ÿï¼Œå‡ºç°æ‰€è°“çš„ã€Œç‚¸æœº\/ç‚¸å²›ã€ç°è±¡ã€‚å¦å¤–ï¼Œè¿™ç§æ¨¡å¼ä¼šéœ€è¦ç”²ä¸»æœºä¸€ç›´å­˜æ´»ï¼Œåªèƒ½ä½œä¸ºçŸ­æ—¶é—´å†…çš„ä¼ºæœæ–¹æ¡ˆã€‚æ‰€ä»¥æœ‰äº›æ¸¸æˆä¼šå¼•å…¥ä¸€ä¸ªå¤–éƒ¨è‡ªå»º\/å®˜æ–¹çš„æœåŠ¡å™¨æ¥æ‰¿æ‹…è¿™ä¸ªçŠ¶æ€åŒæ­¥çš„åŠŸèƒ½ï¼Œä¾‹å¦‚æˆ‘çš„ä¸–ç•Œã€‚ä½†ç©¶å…¶åŸç†æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚\nNAT ç©¿é€ åœ¨äº†è§£å®Œä¸Šé¢çš„åŸºç¡€çŸ¥è¯†åï¼Œæˆ‘ä»¬èƒ½å¤Ÿå‘ç°ï¼Œåœ¨ä¸è€ƒè™‘å¤–éƒ¨æœåŠ¡å™¨çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šå¯¹ç©å®¶ä¸»æœºé—´çš„ç½‘ç»œæœ‰ä»¥ä¸‹å‡ ç‚¹è¦æ±‚ï¼š\nç”²èƒ½å¤Ÿå‘ä¹™ã€ä¸™å‘é€æ•°æ® ä¹™ã€ä¸™èƒ½å¤Ÿå‘ç”²å‘é€æ•°æ® ä¹™ã€ä¸™ä¹‹é—´ä¸éœ€è¦æœ‰ç½‘ç»œè”é€šä¿éšœ è™½ç„¶ä¸Šè¿°è¦æ±‚çœ‹èµ·æ¥å¾ˆå®¹æ˜“ï¼Œä½†æ˜¯ç”±äºç°åœ¨ç½‘ç»œè¿è¥å•†éƒ½ä¼šä¸åŒç¨‹åº¦åœ°ä½¿ç”¨ NAT æŠ€æœ¯ï¼Œæ‰€ä»¥å¯¼è‡´è¦è®©ä¸¤å°å®¶ç”¨ä¸»æœºå»ºç«‹åŒå‘é€šä¿¡å¹¶ä¸æ˜¯ä¸€ä»¶éå¸¸å®¹æ˜“çš„äº‹æƒ…ã€‚\nå®¶ç”¨ç½‘ç»œä¸€èˆ¬æœ‰å››ç§ä¸åŒçš„ NAT ç±»å‹ï¼š\nFull-cone NATï¼š\nOnce an internal address (iAddr:iPort) is mapped to an external address (eAddr:ePort), any packets from iAddr:iPort are sent through eAddr:ePort. Any external host can send packets to iAddr:iPort by sending packets to eAddr:ePort. (Address)-restricted-cone NATï¼š\nOnce an internal address (iAddr:iPort) is mapped to an external address (eAddr:ePort), any packets from iAddr:iPort are sent through eAddr:ePort. An external host (hAddr:any) can send packets to iAddr:iPort by sending packets to eAddr:ePort only if iAddr:iPort has previously sent a packet to hAddr:any. \u0026ldquo;Any\u0026rdquo; means the port number doesn\u0026rsquo;t matter. ","inLanguage":"en-US","author":"Joway","creator":"Joway","publisher":"Joway","accountablePerson":"Joway","copyrightHolder":"Joway","copyrightYear":"2020","datePublished":"2020-05-13 00:00:00 \u002b0000 UTC","dateModified":"2020-05-13 00:00:00 \u002b0000 UTC","url":"https:\/\/blog.joway.io\/posts\/how-animal-crossing-online-work\/","keywords":[]}</script><title>ä»åŠ¨ç‰©æ£®å‹ä¼šèŠä¸»æœºæ¸¸æˆè”æœºæœºåˆ¶</title><meta property="og:title" content="ä»åŠ¨ç‰©æ£®å‹ä¼šèŠä¸»æœºæ¸¸æˆè”æœºæœºåˆ¶"><meta property="og:type" content="article"><meta property="og:description" content="æœ€è¿‘åœ¨ç©åŠ¨ç‰©æ£®å‹ä¼šçš„æ—¶å€™æ—¶å¸¸ä¼šé‡åˆ°ä¸€äº›è¿·ä¹‹è”æœºé—®é¢˜ï¼Œåœ¨ç½‘ä¸Šä¸€ç•ªæœç´¢ï¼Œå‘ç°å¤§å®¶çš„ç­”æ¡ˆéƒ½è¶‹äºç”¨ç„å­¦æ¥è§£é‡Šï¼Œäºæ˜¯ä¾¿æœ‰äº†å…´è‡´æƒ³åœ¨åŸç†ä¸Šææ‡‚è¿™äº›é—®é¢˜äº§ç”Ÿçš„æ ¹æºä»¥åŠåŠ¨æ£®è¿™æ¬¾æ¸¸æˆçš„ä¸€äº›è”æœºè®¾å®šèƒŒåçš„æŠ€æœ¯åŸå› ã€‚
äº‹å…ˆå£°æ˜ï¼Œæœ¬äººå¹¶ä¸ä»äº‹æ¸¸æˆè¡Œä¸šäº¦éä¸»æœºæ¸¸æˆé•¿æœŸç©å®¶ï¼Œå¦‚æœ‰çº°æ¼æˆ–å…¶ä»–è§’åº¦çš„è¡¥å……ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºå‘ŠçŸ¥ã€‚
æ¸¸æˆæ˜¯å¦‚ä½•åŒæ­¥çš„ æˆ‘ä»¬é¦–å…ˆæ¥çœ‹çœ‹ä¸€èˆ¬æ¸¸æˆæ˜¯å¦‚ä½•æ¥åšåŒæ­¥çš„ã€‚
æƒ³è±¡ä¸¤ä¸ªç‹¬ç«‹æˆ¿é—´é‡Œåˆ†åˆ«æœ‰ç”²ã€ä¹™ä¸¤ä¸ªç©å®¶ï¼Œä»–ä»¬è¦è¿œç¨‹ä¸‹ä¸€å±€è±¡æ£‹ã€‚ä»–ä»¬æ¯ä¸‹ä¸€æ­¥å‰éƒ½éœ€è¦å…ˆè·çŸ¥åˆ°å½“å‰æ£‹ç›˜çš„æƒ…å†µï¼Œæ­¤æ—¶èƒ½å¤Ÿæœ‰ä¸¤ç§å®ç°æ–¹å¼ã€‚
ç¬¬ä¸€ç§å«åšé”æ­¥åŒæ­¥ï¼ŒåŸç†æ˜¯ç©å®¶æ¯æ“ä½œä¸€æ­¥å°±é€šçŸ¥ç»™å¦å¤–ä¸€ä¸ªç©å®¶ï¼Œå½¼æ­¤åŒæ­¥å½“å‰çš„æ“ä½œåºåˆ—ï¼Œé€šè¿‡è¿™äº›æœ‰æ—¶åºçš„æ“ä½œï¼Œå°±èƒ½å¤Ÿè®¡ç®—å‡ºå½“å‰æ£‹å±€çš„çŠ¶æ€ã€‚ä½†å®ƒä¸å…è®¸ä¸­é—´ä¸¢å¤±ä»»ä½•ä¸€æ­¥çš„ä¿¡æ¯ï¼Œå¦åˆ™å°±ä¼šå‡ºç°éå¸¸å¤§çš„è®¡ç®—åå·®ã€‚
ç¬¬äºŒç§å«åšçŠ¶æ€åŒæ­¥ï¼Œé¡¾åæ€ä¹‰æ˜¯ç©å®¶æ¯æ“ä½œä¸€æ­¥ï¼Œå°±åŒæ­¥æ•´ä¸ªæ£‹ç›˜çš„çŠ¶æ€ã€‚è¿™ç§æ–¹å¼å¯ä»¥å®¹å¿ä¸­é—´æŸäº›çŠ¶æ€ä¸¢å¤±ï¼Œæœ€ç»ˆå¾—åˆ°çš„çŠ¶æ€ä¾æ—§è¿˜æ˜¯ä¸€è‡´çš„ã€‚
åœ¨å®é™…å®è·µä¸­ï¼Œé’ˆå¯¹é‚£ç§ç©å®¶æ“ä½œéå¸¸é«˜é¢‘çš„æ¸¸æˆä¼šæ›´å¤šä½¿ç”¨é”æ­¥åŒæ­¥ï¼Œä¾‹å¦‚ç‹è€…è£è€€ã€‚è€Œå¯¹äºé‚£äº›å¡ç‰Œç±»æ¸¸æˆæ›´åå‘äºç›´æ¥ç”¨çŠ¶æ€åŒæ­¥ã€‚
æ¸¸æˆæ˜¯å¦‚ä½•è”æœºçš„ é€šä¿¡æ¶æ„ æ— è®ºæ˜¯ä¸Šè¿°å“ªç§åŒæ­¥æ–¹å¼ï¼Œæˆ‘ä»¬éƒ½éœ€è¦é€šè¿‡ç½‘ç»œåœ¨å¤šä¸ªä¸»æœºé—´äº¤æ¢æ•°æ®ã€‚æˆ‘ä»¬ç°åœ¨å°†åœºæ™¯è½¬æ¢æˆç”²ã€ä¹™ã€ä¸™ä¸‰ä¸ªäººä¸€èµ·ä¸‹è·³æ£‹ã€‚ä¸ºä¿è¯ä¸‰ä¸ªäººæœ€ç»ˆå¾—åˆ°çš„æ¸¸æˆçŠ¶æ€éƒ½æ˜¯ä¸€è‡´çš„ï¼Œæˆ‘ä»¬å¾€å¾€éœ€è¦æœ‰ä¸€å° Host ä¸»æœºæ¥ä½œä¸ºæƒå¨ä¸»æœºï¼Œå…¶ä»–ä¸»æœºåªèƒ½é€šè¿‡æƒå¨ä¸»æœºä¸‹å‘çš„æ•°æ®(çŠ¶æ€/æ“ä½œåºåˆ—)æ¥æ›´æ–°è‡ªå·±æœ¬åœ°çš„æ¸¸æˆæ•°æ®ã€‚
åœ¨è¿™é‡Œæˆ‘ä»¬å‡è®¾ç”²æ¥åšã€ŒHostã€ï¼Œä¹™ã€ä¸™æ¯æ“ä½œä¸€æ­¥ï¼Œéƒ½éœ€è¦å…ˆå‘é€ç»™ç”²ç¡®è®¤ï¼Œæ— è¯¯åå†å‘é€è¯¥æ“ä½œè¢«ç¡®è®¤çš„ä¿¡æ¯ç»™ä¹™ã€ä¸™ï¼Œä¹™ã€ä¸™æ­¤æ—¶æ‰èƒ½å¤Ÿè®¤ä¸ºæ“ä½œæˆåŠŸå¹¶å°†ç”»é¢æ›´æ–°åˆ°æœ€æ–°çš„çŠ¶æ€ã€‚ç”²ä¸»æœºä¸Šåœ¨ä»»æ„æ—¶åˆ»éƒ½å­˜æœ‰å½“å‰æ¸¸æˆçš„çœŸæ­£çŠ¶æ€ï¼Œå…¶ä»–ä¸»æœºåªæ˜¯åœ¨ follow ç”²ä¸»æœºçš„çŠ¶æ€ä»¥æ›´æ–°è‡ªå·±çš„æ¸¸æˆç”»é¢ã€‚
åœ¨ä¸Šè¿°æ¨¡å¼ä¸‹ï¼Œç”±äºç”²ä¸»æœºæ—¢è¦ä½œä¸ºæ¸¸æˆä¸»æœºï¼Œåˆè¦ä½œä¸ºçŠ¶æ€åŒæ­¥çš„ä¸»æœºï¼Œå½“è”æœºç”¨æˆ·æ•°ä¸€å¤šï¼Œç”²ä¸»æœºå°±ä¼šä¸å ªé‡è´Ÿï¼Œå‡ºç°æ‰€è°“çš„ã€Œç‚¸æœº/ç‚¸å²›ã€ç°è±¡ã€‚å¦å¤–ï¼Œè¿™ç§æ¨¡å¼ä¼šéœ€è¦ç”²ä¸»æœºä¸€ç›´å­˜æ´»ï¼Œåªèƒ½ä½œä¸ºçŸ­æ—¶é—´å†…çš„ä¼ºæœæ–¹æ¡ˆã€‚æ‰€ä»¥æœ‰äº›æ¸¸æˆä¼šå¼•å…¥ä¸€ä¸ªå¤–éƒ¨è‡ªå»º/å®˜æ–¹çš„æœåŠ¡å™¨æ¥æ‰¿æ‹…è¿™ä¸ªçŠ¶æ€åŒæ­¥çš„åŠŸèƒ½ï¼Œä¾‹å¦‚æˆ‘çš„ä¸–ç•Œã€‚ä½†ç©¶å…¶åŸç†æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚
NAT ç©¿é€ åœ¨äº†è§£å®Œä¸Šé¢çš„åŸºç¡€çŸ¥è¯†åï¼Œæˆ‘ä»¬èƒ½å¤Ÿå‘ç°ï¼Œåœ¨ä¸è€ƒè™‘å¤–éƒ¨æœåŠ¡å™¨çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šå¯¹ç©å®¶ä¸»æœºé—´çš„ç½‘ç»œæœ‰ä»¥ä¸‹å‡ ç‚¹è¦æ±‚ï¼š
ç”²èƒ½å¤Ÿå‘ä¹™ã€ä¸™å‘é€æ•°æ® ä¹™ã€ä¸™èƒ½å¤Ÿå‘ç”²å‘é€æ•°æ® ä¹™ã€ä¸™ä¹‹é—´ä¸éœ€è¦æœ‰ç½‘ç»œè”é€šä¿éšœ è™½ç„¶ä¸Šè¿°è¦æ±‚çœ‹èµ·æ¥å¾ˆå®¹æ˜“ï¼Œä½†æ˜¯ç”±äºç°åœ¨ç½‘ç»œè¿è¥å•†éƒ½ä¼šä¸åŒç¨‹åº¦åœ°ä½¿ç”¨ NAT æŠ€æœ¯ï¼Œæ‰€ä»¥å¯¼è‡´è¦è®©ä¸¤å°å®¶ç”¨ä¸»æœºå»ºç«‹åŒå‘é€šä¿¡å¹¶ä¸æ˜¯ä¸€ä»¶éå¸¸å®¹æ˜“çš„äº‹æƒ…ã€‚
å®¶ç”¨ç½‘ç»œä¸€èˆ¬æœ‰å››ç§ä¸åŒçš„ NAT ç±»å‹ï¼š
Full-cone NATï¼š
Once an internal address (iAddr:iPort) is mapped to an external address (eAddr:ePort), any packets from iAddr:iPort are sent through eAddr:ePort. Any external host can send packets to iAddr:iPort by sending packets to eAddr:ePort. (Address)-restricted-cone NATï¼š
Once an internal address (iAddr:iPort) is mapped to an external address (eAddr:ePort), any packets from iAddr:iPort are sent through eAddr:ePort. An external host (hAddr:any) can send packets to iAddr:iPort by sending packets to eAddr:ePort only if iAddr:iPort has previously sent a packet to hAddr:any. &ldquo;Any&rdquo; means the port number doesn&rsquo;t matter. "><meta name=description content="æœ€è¿‘åœ¨ç©åŠ¨ç‰©æ£®å‹ä¼šçš„æ—¶å€™æ—¶å¸¸ä¼šé‡åˆ°ä¸€äº›è¿·ä¹‹è”æœºé—®é¢˜ï¼Œåœ¨ç½‘ä¸Šä¸€ç•ªæœç´¢ï¼Œå‘ç°å¤§å®¶çš„ç­”æ¡ˆéƒ½è¶‹äºç”¨ç„å­¦æ¥è§£é‡Šï¼Œäºæ˜¯ä¾¿æœ‰äº†å…´è‡´æƒ³åœ¨åŸç†ä¸Šææ‡‚è¿™äº›é—®é¢˜äº§ç”Ÿçš„æ ¹æºä»¥åŠåŠ¨æ£®è¿™æ¬¾æ¸¸æˆçš„ä¸€äº›è”æœºè®¾å®šèƒŒåçš„æŠ€æœ¯åŸå› ã€‚
äº‹å…ˆå£°æ˜ï¼Œæœ¬äººå¹¶ä¸ä»äº‹æ¸¸æˆè¡Œä¸šäº¦éä¸»æœºæ¸¸æˆé•¿æœŸç©å®¶ï¼Œå¦‚æœ‰çº°æ¼æˆ–å…¶ä»–è§’åº¦çš„è¡¥å……ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºå‘ŠçŸ¥ã€‚
æ¸¸æˆæ˜¯å¦‚ä½•åŒæ­¥çš„ æˆ‘ä»¬é¦–å…ˆæ¥çœ‹çœ‹ä¸€èˆ¬æ¸¸æˆæ˜¯å¦‚ä½•æ¥åšåŒæ­¥çš„ã€‚
æƒ³è±¡ä¸¤ä¸ªç‹¬ç«‹æˆ¿é—´é‡Œåˆ†åˆ«æœ‰ç”²ã€ä¹™ä¸¤ä¸ªç©å®¶ï¼Œä»–ä»¬è¦è¿œç¨‹ä¸‹ä¸€å±€è±¡æ£‹ã€‚ä»–ä»¬æ¯ä¸‹ä¸€æ­¥å‰éƒ½éœ€è¦å…ˆè·çŸ¥åˆ°å½“å‰æ£‹ç›˜çš„æƒ…å†µï¼Œæ­¤æ—¶èƒ½å¤Ÿæœ‰ä¸¤ç§å®ç°æ–¹å¼ã€‚
ç¬¬ä¸€ç§å«åšé”æ­¥åŒæ­¥ï¼ŒåŸç†æ˜¯ç©å®¶æ¯æ“ä½œä¸€æ­¥å°±é€šçŸ¥ç»™å¦å¤–ä¸€ä¸ªç©å®¶ï¼Œå½¼æ­¤åŒæ­¥å½“å‰çš„æ“ä½œåºåˆ—ï¼Œé€šè¿‡è¿™äº›æœ‰æ—¶åºçš„æ“ä½œï¼Œå°±èƒ½å¤Ÿè®¡ç®—å‡ºå½“å‰æ£‹å±€çš„çŠ¶æ€ã€‚ä½†å®ƒä¸å…è®¸ä¸­é—´ä¸¢å¤±ä»»ä½•ä¸€æ­¥çš„ä¿¡æ¯ï¼Œå¦åˆ™å°±ä¼šå‡ºç°éå¸¸å¤§çš„è®¡ç®—åå·®ã€‚
ç¬¬äºŒç§å«åšçŠ¶æ€åŒæ­¥ï¼Œé¡¾åæ€ä¹‰æ˜¯ç©å®¶æ¯æ“ä½œä¸€æ­¥ï¼Œå°±åŒæ­¥æ•´ä¸ªæ£‹ç›˜çš„çŠ¶æ€ã€‚è¿™ç§æ–¹å¼å¯ä»¥å®¹å¿ä¸­é—´æŸäº›çŠ¶æ€ä¸¢å¤±ï¼Œæœ€ç»ˆå¾—åˆ°çš„çŠ¶æ€ä¾æ—§è¿˜æ˜¯ä¸€è‡´çš„ã€‚
åœ¨å®é™…å®è·µä¸­ï¼Œé’ˆå¯¹é‚£ç§ç©å®¶æ“ä½œéå¸¸é«˜é¢‘çš„æ¸¸æˆä¼šæ›´å¤šä½¿ç”¨é”æ­¥åŒæ­¥ï¼Œä¾‹å¦‚ç‹è€…è£è€€ã€‚è€Œå¯¹äºé‚£äº›å¡ç‰Œç±»æ¸¸æˆæ›´åå‘äºç›´æ¥ç”¨çŠ¶æ€åŒæ­¥ã€‚
æ¸¸æˆæ˜¯å¦‚ä½•è”æœºçš„ é€šä¿¡æ¶æ„ æ— è®ºæ˜¯ä¸Šè¿°å“ªç§åŒæ­¥æ–¹å¼ï¼Œæˆ‘ä»¬éƒ½éœ€è¦é€šè¿‡ç½‘ç»œåœ¨å¤šä¸ªä¸»æœºé—´äº¤æ¢æ•°æ®ã€‚æˆ‘ä»¬ç°åœ¨å°†åœºæ™¯è½¬æ¢æˆç”²ã€ä¹™ã€ä¸™ä¸‰ä¸ªäººä¸€èµ·ä¸‹è·³æ£‹ã€‚ä¸ºä¿è¯ä¸‰ä¸ªäººæœ€ç»ˆå¾—åˆ°çš„æ¸¸æˆçŠ¶æ€éƒ½æ˜¯ä¸€è‡´çš„ï¼Œæˆ‘ä»¬å¾€å¾€éœ€è¦æœ‰ä¸€å° Host ä¸»æœºæ¥ä½œä¸ºæƒå¨ä¸»æœºï¼Œå…¶ä»–ä¸»æœºåªèƒ½é€šè¿‡æƒå¨ä¸»æœºä¸‹å‘çš„æ•°æ®(çŠ¶æ€/æ“ä½œåºåˆ—)æ¥æ›´æ–°è‡ªå·±æœ¬åœ°çš„æ¸¸æˆæ•°æ®ã€‚
åœ¨è¿™é‡Œæˆ‘ä»¬å‡è®¾ç”²æ¥åšã€ŒHostã€ï¼Œä¹™ã€ä¸™æ¯æ“ä½œä¸€æ­¥ï¼Œéƒ½éœ€è¦å…ˆå‘é€ç»™ç”²ç¡®è®¤ï¼Œæ— è¯¯åå†å‘é€è¯¥æ“ä½œè¢«ç¡®è®¤çš„ä¿¡æ¯ç»™ä¹™ã€ä¸™ï¼Œä¹™ã€ä¸™æ­¤æ—¶æ‰èƒ½å¤Ÿè®¤ä¸ºæ“ä½œæˆåŠŸå¹¶å°†ç”»é¢æ›´æ–°åˆ°æœ€æ–°çš„çŠ¶æ€ã€‚ç”²ä¸»æœºä¸Šåœ¨ä»»æ„æ—¶åˆ»éƒ½å­˜æœ‰å½“å‰æ¸¸æˆçš„çœŸæ­£çŠ¶æ€ï¼Œå…¶ä»–ä¸»æœºåªæ˜¯åœ¨ follow ç”²ä¸»æœºçš„çŠ¶æ€ä»¥æ›´æ–°è‡ªå·±çš„æ¸¸æˆç”»é¢ã€‚
åœ¨ä¸Šè¿°æ¨¡å¼ä¸‹ï¼Œç”±äºç”²ä¸»æœºæ—¢è¦ä½œä¸ºæ¸¸æˆä¸»æœºï¼Œåˆè¦ä½œä¸ºçŠ¶æ€åŒæ­¥çš„ä¸»æœºï¼Œå½“è”æœºç”¨æˆ·æ•°ä¸€å¤šï¼Œç”²ä¸»æœºå°±ä¼šä¸å ªé‡è´Ÿï¼Œå‡ºç°æ‰€è°“çš„ã€Œç‚¸æœº/ç‚¸å²›ã€ç°è±¡ã€‚å¦å¤–ï¼Œè¿™ç§æ¨¡å¼ä¼šéœ€è¦ç”²ä¸»æœºä¸€ç›´å­˜æ´»ï¼Œåªèƒ½ä½œä¸ºçŸ­æ—¶é—´å†…çš„ä¼ºæœæ–¹æ¡ˆã€‚æ‰€ä»¥æœ‰äº›æ¸¸æˆä¼šå¼•å…¥ä¸€ä¸ªå¤–éƒ¨è‡ªå»º/å®˜æ–¹çš„æœåŠ¡å™¨æ¥æ‰¿æ‹…è¿™ä¸ªçŠ¶æ€åŒæ­¥çš„åŠŸèƒ½ï¼Œä¾‹å¦‚æˆ‘çš„ä¸–ç•Œã€‚ä½†ç©¶å…¶åŸç†æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚
NAT ç©¿é€ åœ¨äº†è§£å®Œä¸Šé¢çš„åŸºç¡€çŸ¥è¯†åï¼Œæˆ‘ä»¬èƒ½å¤Ÿå‘ç°ï¼Œåœ¨ä¸è€ƒè™‘å¤–éƒ¨æœåŠ¡å™¨çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šå¯¹ç©å®¶ä¸»æœºé—´çš„ç½‘ç»œæœ‰ä»¥ä¸‹å‡ ç‚¹è¦æ±‚ï¼š
ç”²èƒ½å¤Ÿå‘ä¹™ã€ä¸™å‘é€æ•°æ® ä¹™ã€ä¸™èƒ½å¤Ÿå‘ç”²å‘é€æ•°æ® ä¹™ã€ä¸™ä¹‹é—´ä¸éœ€è¦æœ‰ç½‘ç»œè”é€šä¿éšœ è™½ç„¶ä¸Šè¿°è¦æ±‚çœ‹èµ·æ¥å¾ˆå®¹æ˜“ï¼Œä½†æ˜¯ç”±äºç°åœ¨ç½‘ç»œè¿è¥å•†éƒ½ä¼šä¸åŒç¨‹åº¦åœ°ä½¿ç”¨ NAT æŠ€æœ¯ï¼Œæ‰€ä»¥å¯¼è‡´è¦è®©ä¸¤å°å®¶ç”¨ä¸»æœºå»ºç«‹åŒå‘é€šä¿¡å¹¶ä¸æ˜¯ä¸€ä»¶éå¸¸å®¹æ˜“çš„äº‹æƒ…ã€‚
å®¶ç”¨ç½‘ç»œä¸€èˆ¬æœ‰å››ç§ä¸åŒçš„ NAT ç±»å‹ï¼š
Full-cone NATï¼š
Once an internal address (iAddr:iPort) is mapped to an external address (eAddr:ePort), any packets from iAddr:iPort are sent through eAddr:ePort. Any external host can send packets to iAddr:iPort by sending packets to eAddr:ePort. (Address)-restricted-cone NATï¼š
Once an internal address (iAddr:iPort) is mapped to an external address (eAddr:ePort), any packets from iAddr:iPort are sent through eAddr:ePort. An external host (hAddr:any) can send packets to iAddr:iPort by sending packets to eAddr:ePort only if iAddr:iPort has previously sent a packet to hAddr:any. &ldquo;Any&rdquo; means the port number doesn&rsquo;t matter. "><meta property="og:locale" content="cn"><meta property="og:image" content="/logo.png"><style>:root{--bg-color:#ffffff;--text-color:#000000;--link-color:#000000;--border-color:#482936;--secondary-text:#666666;--code-bg:#f6f8fa;--blockquote-color:#57606a;--blockquote-border:#d0d7de;--disqus-bg:white}[data-theme=dark]{--bg-color:#1a1a1a;--text-color:#e0e0e0;--link-color:#b0b0b0;--border-color:#8b5a7a;--secondary-text:#aaaaaa;--code-bg:#2d2d2d;--blockquote-color:#a0a0a0;--blockquote-border:#404040;--disqus-bg:#1a1a1a}body{font-family:bree serif,sans-serif;-webkit-font-smoothing:antialiased;margin:0 20px;background-color:var(--bg-color);color:var(--text-color)}article{max-width:800px;margin-left:auto;margin-right:auto}a{color:var(--link-color);text-decoration:none}a:hover{font-weight:600;text-decoration:underline}.post-ads{margin:50px 0}.markdown-body{font-size:18px;max-width:100%}.markdown-body a{text-decoration:underline;text-decoration-color:var(--link-color)}.markdown-body blockquote{margin:0;padding:0 1em;color:var(--blockquote-color);border-left:.25em solid var(--blockquote-border)}.markdown-body pre{padding:16px;overflow:auto;border-radius:10px;background-color:var(--code-bg)}.markdown-body code{padding:.2em .4em;font-size:85%;background-color:var(--code-bg);border-radius:6px}.markdown-body pre>code{padding:0;font-size:100%;background-color:var(--code-bg);border:0}.Chinese .markdown-body{line-height:200%}.site-date-catalog{font-size:2rem}.header-title{font-size:2rem;font-weight:700;margin-top:32px;font-family:bungee shade,sans-serif}.header-title a{text-decoration:none}.header-subtitle{color:var(--secondary-text)}.header-items{margin:10px 0}.header-item{margin:0 5px}.header-line{width:100%;border-width:2px;border-color:var(--border-color);border-style:solid none none none}.lang-switch{font-weight:600}.theme-toggle{background:0 0;border:none;color:var(--link-color);cursor:pointer;font-weight:600;font-size:inherit;padding:0}.theme-toggle:hover{font-weight:800}#posts-list{min-height:600px}.posts-line{font-size:1.2rem;margin:12px 0}.posts-categories{font-size:.8rem;margin:auto;text-align:center}.posts-category{padding:3px 0;border:var(--text-color)2px solid;border-radius:5px}.site-footer{margin-top:50px}.site-footer-item{margin-right:12px}.post-header{margin-bottom:50px}.post-title{font-size:2rem;font-weight:600}.post-tags{display:inline;font-weight:600;padding:2px 5px;margin-right:6px;border:var(--text-color)2px solid;border-radius:5px}.post-date{font-weight:800;font-style:italic}.post-author{float:right;font-weight:600}.page-content{min-height:60%}.post-content{margin-bottom:50px}.post-content p{hyphens:auto;line-height:1.8;text-justify:ideographic;margin-bottom:1em}.post-content img{max-width:100%;display:block;margin-right:auto;margin-top:6px}.post-content .post-gallery{display:flex;flex-wrap:wrap;gap:6px}.post-content .post-gallery img{margin-right:auto;margin-top:auto;width:calc(50% - 3px)}.related-content{border-width:3px;border-style:solid;border-color:var(--text-color);padding:0 10px;margin-bottom:50px;margin-top:100px}.related-content li{margin:5px 0}.taxonomy-term{font-size:3rem}.gallery-img{text-align:center}.gallery-img span{text-align:center}.gallery-img-desc{font-size:.8em;font-weight:800}#disqus_thread{position:relative}#disqus_thread:after{content:"";display:block;height:55px;width:100%;position:absolute;bottom:0;background:var(--disqus-bg)}@media screen and (max-width:600px){.header-title,.header-subtitle,.header-items{}.posts-line{font-size:16px}.markdown-body{font-size:16px}.post-title{font-size:2rem}.post-content p{letter-spacing:.05em}.post-content .post-gallery img{width:100%}}@media screen and (max-width:48em){.posts-category{display:none}}</style><style>.container,.container-fluid{margin-right:auto;margin-left:auto}.container-fluid{padding-right:2rem;padding-left:2rem}.row{box-sizing:border-box;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:0;-ms-flex:0 1 auto;flex:initial;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-right:-.5rem;margin-left:-.5rem}.row.reverse{-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.col.reverse{-webkit-box-orient:vertical;-webkit-box-direction:reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse}.col-xs,.col-xs-1,.col-xs-10,.col-xs-11,.col-xs-12,.col-xs-2,.col-xs-3,.col-xs-4,.col-xs-5,.col-xs-6,.col-xs-7,.col-xs-8,.col-xs-9,.col-xs-offset-0,.col-xs-offset-1,.col-xs-offset-10,.col-xs-offset-11,.col-xs-offset-12,.col-xs-offset-2,.col-xs-offset-3,.col-xs-offset-4,.col-xs-offset-5,.col-xs-offset-6,.col-xs-offset-7,.col-xs-offset-8,.col-xs-offset-9{box-sizing:border-box;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:none;padding-right:.5rem;padding-left:.5rem}.col-xs{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:0;flex-basis:0;max-width:100%}.col-xs-1{-ms-flex-preferred-size:8.33333333%;flex-basis:8.33333333%;max-width:8.33333333%}.col-xs-2{-ms-flex-preferred-size:16.66666667%;flex-basis:16.66666667%;max-width:16.66666667%}.col-xs-3{-ms-flex-preferred-size:25%;flex-basis:25%;max-width:25%}.col-xs-4{-ms-flex-preferred-size:33.33333333%;flex-basis:33.33333333%;max-width:33.33333333%}.col-xs-5{-ms-flex-preferred-size:41.66666667%;flex-basis:41.66666667%;max-width:41.66666667%}.col-xs-6{-ms-flex-preferred-size:50%;flex-basis:50%;max-width:50%}.col-xs-7{-ms-flex-preferred-size:58.33333333%;flex-basis:58.33333333%;max-width:58.33333333%}.col-xs-8{-ms-flex-preferred-size:66.66666667%;flex-basis:66.66666667%;max-width:66.66666667%}.col-xs-9{-ms-flex-preferred-size:75%;flex-basis:75%;max-width:75%}.col-xs-10{-ms-flex-preferred-size:83.33333333%;flex-basis:83.33333333%;max-width:83.33333333%}.col-xs-11{-ms-flex-preferred-size:91.66666667%;flex-basis:91.66666667%;max-width:91.66666667%}.col-xs-12{-ms-flex-preferred-size:100%;flex-basis:100%;max-width:100%}.col-xs-offset-0{margin-left:0}.col-xs-offset-1{margin-left:8.33333333%}.col-xs-offset-2{margin-left:16.66666667%}.col-xs-offset-3{margin-left:25%}.col-xs-offset-4{margin-left:33.33333333%}.col-xs-offset-5{margin-left:41.66666667%}.col-xs-offset-6{margin-left:50%}.col-xs-offset-7{margin-left:58.33333333%}.col-xs-offset-8{margin-left:66.66666667%}.col-xs-offset-9{margin-left:75%}.col-xs-offset-10{margin-left:83.33333333%}.col-xs-offset-11{margin-left:91.66666667%}.start-xs{-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;text-align:start}.center-xs{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;text-align:center}.end-xs{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;text-align:end}.top-xs{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.middle-xs{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.bottom-xs{-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}.around-xs{-ms-flex-pack:distribute;justify-content:space-around}.between-xs{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.first-xs{-webkit-box-ordinal-group:0;-ms-flex-order:-1;order:-1}.last-xs{-webkit-box-ordinal-group:2;-ms-flex-order:1;order:1}@media only screen and (min-width:48em){.container{width:49rem}.col-sm,.col-sm-1,.col-sm-10,.col-sm-11,.col-sm-12,.col-sm-2,.col-sm-3,.col-sm-4,.col-sm-5,.col-sm-6,.col-sm-7,.col-sm-8,.col-sm-9,.col-sm-offset-0,.col-sm-offset-1,.col-sm-offset-10,.col-sm-offset-11,.col-sm-offset-12,.col-sm-offset-2,.col-sm-offset-3,.col-sm-offset-4,.col-sm-offset-5,.col-sm-offset-6,.col-sm-offset-7,.col-sm-offset-8,.col-sm-offset-9{box-sizing:border-box;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:none;padding-right:.5rem;padding-left:.5rem}.col-sm{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:0;flex-basis:0;max-width:100%}.col-sm-1{-ms-flex-preferred-size:8.33333333%;flex-basis:8.33333333%;max-width:8.33333333%}.col-sm-2{-ms-flex-preferred-size:16.66666667%;flex-basis:16.66666667%;max-width:16.66666667%}.col-sm-3{-ms-flex-preferred-size:25%;flex-basis:25%;max-width:25%}.col-sm-4{-ms-flex-preferred-size:33.33333333%;flex-basis:33.33333333%;max-width:33.33333333%}.col-sm-5{-ms-flex-preferred-size:41.66666667%;flex-basis:41.66666667%;max-width:41.66666667%}.col-sm-6{-ms-flex-preferred-size:50%;flex-basis:50%;max-width:50%}.col-sm-7{-ms-flex-preferred-size:58.33333333%;flex-basis:58.33333333%;max-width:58.33333333%}.col-sm-8{-ms-flex-preferred-size:66.66666667%;flex-basis:66.66666667%;max-width:66.66666667%}.col-sm-9{-ms-flex-preferred-size:75%;flex-basis:75%;max-width:75%}.col-sm-10{-ms-flex-preferred-size:83.33333333%;flex-basis:83.33333333%;max-width:83.33333333%}.col-sm-11{-ms-flex-preferred-size:91.66666667%;flex-basis:91.66666667%;max-width:91.66666667%}.col-sm-12{-ms-flex-preferred-size:100%;flex-basis:100%;max-width:100%}.col-sm-offset-0{margin-left:0}.col-sm-offset-1{margin-left:8.33333333%}.col-sm-offset-2{margin-left:16.66666667%}.col-sm-offset-3{margin-left:25%}.col-sm-offset-4{margin-left:33.33333333%}.col-sm-offset-5{margin-left:41.66666667%}.col-sm-offset-6{margin-left:50%}.col-sm-offset-7{margin-left:58.33333333%}.col-sm-offset-8{margin-left:66.66666667%}.col-sm-offset-9{margin-left:75%}.col-sm-offset-10{margin-left:83.33333333%}.col-sm-offset-11{margin-left:91.66666667%}.start-sm{-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;text-align:start}.center-sm{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;text-align:center}.end-sm{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;text-align:end}.top-sm{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.middle-sm{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.bottom-sm{-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}.around-sm{-ms-flex-pack:distribute;justify-content:space-around}.between-sm{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.first-sm{-webkit-box-ordinal-group:0;-ms-flex-order:-1;order:-1}.last-sm{-webkit-box-ordinal-group:2;-ms-flex-order:1;order:1}}@media only screen and (min-width:64em){.container{width:65rem}.col-md,.col-md-1,.col-md-10,.col-md-11,.col-md-12,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9,.col-md-offset-0,.col-md-offset-1,.col-md-offset-10,.col-md-offset-11,.col-md-offset-12,.col-md-offset-2,.col-md-offset-3,.col-md-offset-4,.col-md-offset-5,.col-md-offset-6,.col-md-offset-7,.col-md-offset-8,.col-md-offset-9{box-sizing:border-box;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:none;padding-right:.5rem;padding-left:.5rem}.col-md{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:0;flex-basis:0;max-width:100%}.col-md-1{-ms-flex-preferred-size:8.33333333%;flex-basis:8.33333333%;max-width:8.33333333%}.col-md-2{-ms-flex-preferred-size:16.66666667%;flex-basis:16.66666667%;max-width:16.66666667%}.col-md-3{-ms-flex-preferred-size:25%;flex-basis:25%;max-width:25%}.col-md-4{-ms-flex-preferred-size:33.33333333%;flex-basis:33.33333333%;max-width:33.33333333%}.col-md-5{-ms-flex-preferred-size:41.66666667%;flex-basis:41.66666667%;max-width:41.66666667%}.col-md-6{-ms-flex-preferred-size:50%;flex-basis:50%;max-width:50%}.col-md-7{-ms-flex-preferred-size:58.33333333%;flex-basis:58.33333333%;max-width:58.33333333%}.col-md-8{-ms-flex-preferred-size:66.66666667%;flex-basis:66.66666667%;max-width:66.66666667%}.col-md-9{-ms-flex-preferred-size:75%;flex-basis:75%;max-width:75%}.col-md-10{-ms-flex-preferred-size:83.33333333%;flex-basis:83.33333333%;max-width:83.33333333%}.col-md-11{-ms-flex-preferred-size:91.66666667%;flex-basis:91.66666667%;max-width:91.66666667%}.col-md-12{-ms-flex-preferred-size:100%;flex-basis:100%;max-width:100%}.col-md-offset-0{margin-left:0}.col-md-offset-1{margin-left:8.33333333%}.col-md-offset-2{margin-left:16.66666667%}.col-md-offset-3{margin-left:25%}.col-md-offset-4{margin-left:33.33333333%}.col-md-offset-5{margin-left:41.66666667%}.col-md-offset-6{margin-left:50%}.col-md-offset-7{margin-left:58.33333333%}.col-md-offset-8{margin-left:66.66666667%}.col-md-offset-9{margin-left:75%}.col-md-offset-10{margin-left:83.33333333%}.col-md-offset-11{margin-left:91.66666667%}.start-md{-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;text-align:start}.center-md{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;text-align:center}.end-md{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;text-align:end}.top-md{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.middle-md{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.bottom-md{-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}.around-md{-ms-flex-pack:distribute;justify-content:space-around}.between-md{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.first-md{-webkit-box-ordinal-group:0;-ms-flex-order:-1;order:-1}.last-md{-webkit-box-ordinal-group:2;-ms-flex-order:1;order:1}}@media only screen and (min-width:75em){.container{width:76rem}.col-lg,.col-lg-1,.col-lg-10,.col-lg-11,.col-lg-12,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9,.col-lg-offset-0,.col-lg-offset-1,.col-lg-offset-10,.col-lg-offset-11,.col-lg-offset-12,.col-lg-offset-2,.col-lg-offset-3,.col-lg-offset-4,.col-lg-offset-5,.col-lg-offset-6,.col-lg-offset-7,.col-lg-offset-8,.col-lg-offset-9{box-sizing:border-box;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:none;padding-right:.5rem;padding-left:.5rem}.col-lg{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:0;flex-basis:0;max-width:100%}.col-lg-1{-ms-flex-preferred-size:8.33333333%;flex-basis:8.33333333%;max-width:8.33333333%}.col-lg-2{-ms-flex-preferred-size:16.66666667%;flex-basis:16.66666667%;max-width:16.66666667%}.col-lg-3{-ms-flex-preferred-size:25%;flex-basis:25%;max-width:25%}.col-lg-4{-ms-flex-preferred-size:33.33333333%;flex-basis:33.33333333%;max-width:33.33333333%}.col-lg-5{-ms-flex-preferred-size:41.66666667%;flex-basis:41.66666667%;max-width:41.66666667%}.col-lg-6{-ms-flex-preferred-size:50%;flex-basis:50%;max-width:50%}.col-lg-7{-ms-flex-preferred-size:58.33333333%;flex-basis:58.33333333%;max-width:58.33333333%}.col-lg-8{-ms-flex-preferred-size:66.66666667%;flex-basis:66.66666667%;max-width:66.66666667%}.col-lg-9{-ms-flex-preferred-size:75%;flex-basis:75%;max-width:75%}.col-lg-10{-ms-flex-preferred-size:83.33333333%;flex-basis:83.33333333%;max-width:83.33333333%}.col-lg-11{-ms-flex-preferred-size:91.66666667%;flex-basis:91.66666667%;max-width:91.66666667%}.col-lg-12{-ms-flex-preferred-size:100%;flex-basis:100%;max-width:100%}.col-lg-offset-0{margin-left:0}.col-lg-offset-1{margin-left:8.33333333%}.col-lg-offset-2{margin-left:16.66666667%}.col-lg-offset-3{margin-left:25%}.col-lg-offset-4{margin-left:33.33333333%}.col-lg-offset-5{margin-left:41.66666667%}.col-lg-offset-6{margin-left:50%}.col-lg-offset-7{margin-left:58.33333333%}.col-lg-offset-8{margin-left:66.66666667%}.col-lg-offset-9{margin-left:75%}.col-lg-offset-10{margin-left:83.33333333%}.col-lg-offset-11{margin-left:91.66666667%}.start-lg{-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;text-align:start}.center-lg{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;text-align:center}.end-lg{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;text-align:end}.top-lg{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.middle-lg{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.bottom-lg{-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}.around-lg{-ms-flex-pack:distribute;justify-content:space-around}.between-lg{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.first-lg{-webkit-box-ordinal-group:0;-ms-flex-order:-1;order:-1}.last-lg{-webkit-box-ordinal-group:2;-ms-flex-order:1;order:1}}</style><link href=https://cdn.jsdelivr.net/gh/joway/blog/index.xml rel=alternate type=application/rss+xml title="Random Thoughts"><link rel=preconnect href=https://fonts.gstatic.com><link href="https://fonts.googleapis.com/css?family=Bree+Serif|Bungee+Shade" rel=stylesheet><script data-cfasync=false>(function(){const o="theme",e={light:"light",dark:"dark",system:"system"};function t(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function n(){return localStorage.getItem(o)}function r(){const s=n();return s&&s!==e.system?s:t()}function s(n){const s=document.documentElement;n===e.system&&(n=t()),n===e.dark?s.setAttribute("data-theme","dark"):s.removeAttribute("data-theme"),i(n)}function i(e){const t=document.getElementById("theme-toggle");t&&(t.textContent=e==="dark"?"â˜€ï¸":"ğŸŒ™")}function a(){i(r())}function c(){const o=n();let i;o?(i=o===e.system?t():o,s(o)):(i=t(),s(e.system))}function l(){const a=n()||e.system;let i;a===e.system?i=t()==="dark"?e.light:e.dark:a===e.dark?i=e.light:i=e.dark,localStorage.setItem(o,i),s(i)}window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",function(){const t=n();(!t||t===e.system)&&s(e.system)}),document.readyState==="loading"?document.addEventListener("DOMContentLoaded",a):a(),window.toggleTheme=l,c()})()</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-53624533-8"></script><script src=https://cdn.jsdelivr.net/gh/joway/homepage/analytics.js></script><article class="post ç®€ä½“ä¸­æ–‡" id=article><div class=row><div class=col-xs-12><div class=site-header><header><div class=header-title><a href=/>Random Thoughts</a></div><div class=header-subtitle>Log something useless, but interesting.</div></header><div class="row end-md header-items"><div class=header-item><a href=https://mailchi.mp/a1a0d59e7a19/joway target=_blank>Subscribe</a></div><div class=header-item><a href=/travel target=_blank>Travel</a></div><div class=header-item><a href=https://joway.io target=_blank>About</a></div><div class=header-item><button id=theme-toggle onclick=toggleTheme() class=theme-toggle>ğŸŒ™</button></div></div><div class=row></div><div class=header-line></div></div><header class=post-header><h1 class=post-title>ä»åŠ¨ç‰©æ£®å‹ä¼šèŠä¸»æœºæ¸¸æˆè”æœºæœºåˆ¶</h1><div class="row post-desc"><div class=col-xs-6><time class=post-date datetime="2020-05-13 00:00:00 UTC">13 May 2020</time></div><div class=col-xs-6><div class=post-author><a target=_blank href>@Joway</a></div></div></div></header><div class="post-content markdown-body"><p>æœ€è¿‘åœ¨ç©åŠ¨ç‰©æ£®å‹ä¼šçš„æ—¶å€™æ—¶å¸¸ä¼šé‡åˆ°ä¸€äº›è¿·ä¹‹è”æœºé—®é¢˜ï¼Œåœ¨ç½‘ä¸Šä¸€ç•ªæœç´¢ï¼Œå‘ç°å¤§å®¶çš„ç­”æ¡ˆéƒ½è¶‹äºç”¨ç„å­¦æ¥è§£é‡Šï¼Œäºæ˜¯ä¾¿æœ‰äº†å…´è‡´æƒ³åœ¨åŸç†ä¸Šææ‡‚è¿™äº›é—®é¢˜äº§ç”Ÿçš„æ ¹æºä»¥åŠåŠ¨æ£®è¿™æ¬¾æ¸¸æˆçš„ä¸€äº›è”æœºè®¾å®šèƒŒåçš„æŠ€æœ¯åŸå› ã€‚<p>äº‹å…ˆå£°æ˜ï¼Œæœ¬äººå¹¶ä¸ä»äº‹æ¸¸æˆè¡Œä¸šäº¦éä¸»æœºæ¸¸æˆé•¿æœŸç©å®¶ï¼Œå¦‚æœ‰çº°æ¼æˆ–å…¶ä»–è§’åº¦çš„è¡¥å……ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºå‘ŠçŸ¥ã€‚<h2 id=æ¸¸æˆæ˜¯å¦‚ä½•åŒæ­¥çš„>æ¸¸æˆæ˜¯å¦‚ä½•åŒæ­¥çš„</h2><p>æˆ‘ä»¬é¦–å…ˆæ¥çœ‹çœ‹ä¸€èˆ¬æ¸¸æˆæ˜¯å¦‚ä½•æ¥åšåŒæ­¥çš„ã€‚<p>æƒ³è±¡ä¸¤ä¸ªç‹¬ç«‹æˆ¿é—´é‡Œåˆ†åˆ«æœ‰ç”²ã€ä¹™ä¸¤ä¸ªç©å®¶ï¼Œä»–ä»¬è¦è¿œç¨‹ä¸‹ä¸€å±€è±¡æ£‹ã€‚ä»–ä»¬æ¯ä¸‹ä¸€æ­¥å‰éƒ½éœ€è¦å…ˆè·çŸ¥åˆ°å½“å‰æ£‹ç›˜çš„æƒ…å†µï¼Œæ­¤æ—¶èƒ½å¤Ÿæœ‰ä¸¤ç§å®ç°æ–¹å¼ã€‚<p>ç¬¬ä¸€ç§å«åšé”æ­¥åŒæ­¥ï¼ŒåŸç†æ˜¯ç©å®¶æ¯æ“ä½œä¸€æ­¥å°±é€šçŸ¥ç»™å¦å¤–ä¸€ä¸ªç©å®¶ï¼Œå½¼æ­¤åŒæ­¥å½“å‰çš„æ“ä½œåºåˆ—ï¼Œé€šè¿‡è¿™äº›æœ‰æ—¶åºçš„æ“ä½œï¼Œå°±èƒ½å¤Ÿè®¡ç®—å‡ºå½“å‰æ£‹å±€çš„çŠ¶æ€ã€‚ä½†å®ƒä¸å…è®¸ä¸­é—´ä¸¢å¤±ä»»ä½•ä¸€æ­¥çš„ä¿¡æ¯ï¼Œå¦åˆ™å°±ä¼šå‡ºç°éå¸¸å¤§çš„è®¡ç®—åå·®ã€‚<p>ç¬¬äºŒç§å«åšçŠ¶æ€åŒæ­¥ï¼Œé¡¾åæ€ä¹‰æ˜¯ç©å®¶æ¯æ“ä½œä¸€æ­¥ï¼Œå°±åŒæ­¥æ•´ä¸ªæ£‹ç›˜çš„çŠ¶æ€ã€‚è¿™ç§æ–¹å¼å¯ä»¥å®¹å¿ä¸­é—´æŸäº›çŠ¶æ€ä¸¢å¤±ï¼Œæœ€ç»ˆå¾—åˆ°çš„çŠ¶æ€ä¾æ—§è¿˜æ˜¯ä¸€è‡´çš„ã€‚<p>åœ¨å®é™…å®è·µä¸­ï¼Œé’ˆå¯¹é‚£ç§ç©å®¶æ“ä½œéå¸¸é«˜é¢‘çš„æ¸¸æˆä¼šæ›´å¤šä½¿ç”¨é”æ­¥åŒæ­¥ï¼Œä¾‹å¦‚ç‹è€…è£è€€ã€‚è€Œå¯¹äºé‚£äº›å¡ç‰Œç±»æ¸¸æˆæ›´åå‘äºç›´æ¥ç”¨çŠ¶æ€åŒæ­¥ã€‚<h2 id=æ¸¸æˆæ˜¯å¦‚ä½•è”æœºçš„>æ¸¸æˆæ˜¯å¦‚ä½•è”æœºçš„</h2><h3 id=é€šä¿¡æ¶æ„>é€šä¿¡æ¶æ„</h3><p>æ— è®ºæ˜¯ä¸Šè¿°å“ªç§åŒæ­¥æ–¹å¼ï¼Œæˆ‘ä»¬éƒ½éœ€è¦é€šè¿‡ç½‘ç»œåœ¨å¤šä¸ªä¸»æœºé—´äº¤æ¢æ•°æ®ã€‚æˆ‘ä»¬ç°åœ¨å°†åœºæ™¯è½¬æ¢æˆç”²ã€ä¹™ã€ä¸™ä¸‰ä¸ªäººä¸€èµ·ä¸‹è·³æ£‹ã€‚ä¸ºä¿è¯ä¸‰ä¸ªäººæœ€ç»ˆå¾—åˆ°çš„æ¸¸æˆçŠ¶æ€éƒ½æ˜¯ä¸€è‡´çš„ï¼Œæˆ‘ä»¬å¾€å¾€éœ€è¦æœ‰ä¸€å° Host ä¸»æœºæ¥ä½œä¸ºæƒå¨ä¸»æœºï¼Œå…¶ä»–ä¸»æœºåªèƒ½é€šè¿‡æƒå¨ä¸»æœºä¸‹å‘çš„æ•°æ®(çŠ¶æ€/æ“ä½œåºåˆ—)æ¥æ›´æ–°è‡ªå·±æœ¬åœ°çš„æ¸¸æˆæ•°æ®ã€‚<p>åœ¨è¿™é‡Œæˆ‘ä»¬å‡è®¾ç”²æ¥åšã€ŒHostã€ï¼Œä¹™ã€ä¸™æ¯æ“ä½œä¸€æ­¥ï¼Œéƒ½éœ€è¦å…ˆå‘é€ç»™ç”²ç¡®è®¤ï¼Œæ— è¯¯åå†å‘é€è¯¥æ“ä½œè¢«ç¡®è®¤çš„ä¿¡æ¯ç»™ä¹™ã€ä¸™ï¼Œä¹™ã€ä¸™æ­¤æ—¶æ‰èƒ½å¤Ÿè®¤ä¸ºæ“ä½œæˆåŠŸå¹¶å°†ç”»é¢æ›´æ–°åˆ°æœ€æ–°çš„çŠ¶æ€ã€‚ç”²ä¸»æœºä¸Šåœ¨ä»»æ„æ—¶åˆ»éƒ½å­˜æœ‰å½“å‰æ¸¸æˆçš„çœŸæ­£çŠ¶æ€ï¼Œå…¶ä»–ä¸»æœºåªæ˜¯åœ¨ follow ç”²ä¸»æœºçš„çŠ¶æ€ä»¥æ›´æ–°è‡ªå·±çš„æ¸¸æˆç”»é¢ã€‚<p>åœ¨ä¸Šè¿°æ¨¡å¼ä¸‹ï¼Œç”±äºç”²ä¸»æœºæ—¢è¦ä½œä¸ºæ¸¸æˆä¸»æœºï¼Œåˆè¦ä½œä¸ºçŠ¶æ€åŒæ­¥çš„ä¸»æœºï¼Œå½“è”æœºç”¨æˆ·æ•°ä¸€å¤šï¼Œç”²ä¸»æœºå°±ä¼šä¸å ªé‡è´Ÿï¼Œå‡ºç°æ‰€è°“çš„ã€Œç‚¸æœº/ç‚¸å²›ã€ç°è±¡ã€‚å¦å¤–ï¼Œè¿™ç§æ¨¡å¼ä¼šéœ€è¦ç”²ä¸»æœºä¸€ç›´å­˜æ´»ï¼Œåªèƒ½ä½œä¸ºçŸ­æ—¶é—´å†…çš„ä¼ºæœæ–¹æ¡ˆã€‚æ‰€ä»¥æœ‰äº›æ¸¸æˆä¼šå¼•å…¥ä¸€ä¸ªå¤–éƒ¨è‡ªå»º/å®˜æ–¹çš„æœåŠ¡å™¨æ¥æ‰¿æ‹…è¿™ä¸ªçŠ¶æ€åŒæ­¥çš„åŠŸèƒ½ï¼Œä¾‹å¦‚æˆ‘çš„ä¸–ç•Œã€‚ä½†ç©¶å…¶åŸç†æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚<h3 id=nat-ç©¿é€>NAT ç©¿é€</h3><p>åœ¨äº†è§£å®Œä¸Šé¢çš„åŸºç¡€çŸ¥è¯†åï¼Œæˆ‘ä»¬èƒ½å¤Ÿå‘ç°ï¼Œåœ¨ä¸è€ƒè™‘å¤–éƒ¨æœåŠ¡å™¨çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šå¯¹ç©å®¶ä¸»æœºé—´çš„ç½‘ç»œæœ‰ä»¥ä¸‹å‡ ç‚¹è¦æ±‚ï¼š<ol><li>ç”²èƒ½å¤Ÿå‘ä¹™ã€ä¸™å‘é€æ•°æ®<li>ä¹™ã€ä¸™èƒ½å¤Ÿå‘ç”²å‘é€æ•°æ®<li>ä¹™ã€ä¸™ä¹‹é—´ä¸éœ€è¦æœ‰ç½‘ç»œè”é€šä¿éšœ</ol><p>è™½ç„¶ä¸Šè¿°è¦æ±‚çœ‹èµ·æ¥å¾ˆå®¹æ˜“ï¼Œä½†æ˜¯ç”±äºç°åœ¨ç½‘ç»œè¿è¥å•†éƒ½ä¼šä¸åŒç¨‹åº¦åœ°ä½¿ç”¨ <a href=https://zh.wikipedia.org/wiki/%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2>NAT</a> æŠ€æœ¯ï¼Œæ‰€ä»¥å¯¼è‡´è¦è®©ä¸¤å°å®¶ç”¨ä¸»æœºå»ºç«‹åŒå‘é€šä¿¡å¹¶ä¸æ˜¯ä¸€ä»¶éå¸¸å®¹æ˜“çš„äº‹æƒ…ã€‚<p>å®¶ç”¨ç½‘ç»œä¸€èˆ¬æœ‰å››ç§ä¸åŒçš„ NAT ç±»å‹ï¼š<p><strong>Full-cone NAT</strong>ï¼š<ul><li>Once an internal address (iAddr:iPort) is mapped to an external address (eAddr:ePort), any packets from iAddr:iPort are sent through eAddr:ePort.<li>Any external host can send packets to iAddr:iPort by sending packets to eAddr:ePort.
<img src=../../images/how-animal-crossing-online-work/Full_Cone_NAT.png alt></ul><p><strong>(Address)-restricted-cone NAT</strong>ï¼š<ul><li>Once an internal address (iAddr:iPort) is mapped to an external address (eAddr:ePort), any packets from iAddr:iPort are sent through eAddr:ePort.<li>An external host (hAddr:any) can send packets to iAddr:iPort by sending packets to eAddr:ePort only if iAddr:iPort has previously sent a packet to hAddr:any. &ldquo;Any&rdquo; means the port number doesn&rsquo;t matter.</ul><p><img src=../../images/how-animal-crossing-online-work/Restricted_Cone_NAT.png alt><p><strong>Port-restricted-cone NAT</strong>ï¼š<ul><li>Once an internal address (iAddr:iPort) is mapped to an external address (eAddr:ePort), any packets from iAddr:iPort are sent through eAddr:ePort.<li>An external host (hAddr:hPort) can send packets to iAddr:iPort by sending packets to eAddr:ePort only if iAddr:iPort has previously sent a packet to hAddr:hPort.</ul><p><img src=../../images/how-animal-crossing-online-work/Port_Restricted_Cone_NAT.png alt><p><strong>Symmetric NAT</strong><ul><li>Each request from the same internal IP address and port to a specific destination IP address and port is mapped to a unique external source IP address and port; if the same internal host sends a packet even with the same source address and port but to a different destination, a different mapping is used.<li>Only an external host that receives a packet from an internal host can send a packet back.</ul><p><img src=../../images/how-animal-crossing-online-work/Symmetric_NAT.png alt><p>ä¸Šè¿°å››ç§ NAT ç±»å‹ç®€å•å½’çº³å°±æ˜¯è¯´ï¼š<ol><li>å‰ä¸‰ç§ cone ç±»å‹çš„ NAT éƒ½èƒ½å°†å†…ç½‘çš„ iAddr:iPort æ˜ å°„åˆ°ä¸€ä¸ªå›ºå®šçš„å¤–ç½‘ eAddr:ePort ä¸Šã€‚åªæœ‰ Symmetric ç±»å‹å¯¹äºä¸€æ ·çš„ iAddr:iPort ä½†ä¸åŒçš„ç›®çš„IPå’Œç«¯å£ä¹Ÿä¼šè¢«æ˜ å°„åˆ°ä¸åŒçš„ eAddr:ePort ä¸Šå»ã€‚<li>å‰ä¸‰ç§ cone ç±»å‹çš„ NAT çš„åŒºåˆ«å¯ä»¥ç›´æ¥ä»åå­—ä¸­çœ‹å‡ºæ¥ï¼Œaddress-restricted-cone è¡¨ç¤ºåªæœ‰è‡ªå·±å¯¹å¤–å‘å‡ºè¿‡åŒ…çš„ address æœ‰èƒ½åŠ›å‘å…¶å‘é€åŒ…ï¼Œport-retricted-cone çš„æ„æ€æ˜¯åªæœ‰è‡ªå·±å¯¹å¤–å‘å‡ºè¿‡åŒ…çš„ address:port åœ°å€æœ‰èƒ½åŠ›å‘å…¶å‘é€åŒ…ã€‚<li>ç¬¬å››ç§ Symmetric ç±»å‹å¯¹å¤–éƒ¨è¿”å›æŠ¥æ–‡æ¥æºçš„é™åˆ¶æ˜¯ä¸ port-retricted-cone ä¸€è‡´çš„ã€‚</ol><p>ä¸»æœºä¸Šçš„ç½‘ç»œæµ‹è¯•åŠŸèƒ½èƒ½å¤Ÿå‘Šè¯‰æˆ‘ä»¬å½“å‰ç½‘ç»œçš„ NAT ç±»å‹ã€‚Switch ä¸Šçš„ Type Aã€Bã€Cã€D åˆ†åˆ«æ˜ å°„åˆ°ä¸Šé¢å››ç§ç±»å‹ï¼Œè€Œ PS4 ä¸Šåˆ™æ˜¯ Type 1(ç›´è¿ï¼Œæ—  NAT)ã€2(é Symmetric NAT)ã€3(Symmetric NAT)ã€‚ä¸ºæ–¹ä¾¿ä¸‹æ–‡å™è¿°ï¼Œæˆ‘ä»¬ç”¨ Switch çš„ ABCD æŒ‡ä»£ä¸Šè¿°å››ç§ç½‘ç»œç±»å‹ã€‚<p>ç†è§£äº†å››ç§ NAT ç±»å‹å„è‡ªçš„é™åˆ¶ï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿé€šè¿‡æ¨å¯¼åˆ¤æ–­å‡ºï¼Œå“ªä¸¤ä¸ª NAT ç±»å‹çš„ç½‘ç»œæ˜¯ä¸å¯èƒ½å»ºç«‹åŒå‘é€šä¿¡çš„ï¼Œè€Œä¸å†éœ€è¦å»äººè‚‰å°è¯•ã€‚è¿™é‡Œæˆ‘ä»¬åˆ†åˆ«ä¸¾ä¾‹æ¥ä»‹ç»ä¸åŒ NAT ç±»å‹ä¸‹çš„ä¸åŒæƒ…å†µï¼Œç”²ä½œä¸º Host ä¸»æœºï¼Œå¹¶ä¸”æˆ‘ä»¬æœ‰ä¸€ä¸ªå¤–éƒ¨çš„è”æœºæœåŠ¡å¯ä»¥è·å–åˆ°ç”²ä¹™çš„å¤–ç½‘ IP ä¿¡æ¯ã€‚æ‰€è°“çš„è”æœºæœåŠ¡æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹æœåŠ¡å™¨ï¼Œç”²ä¹™éƒ½èƒ½é€šè¿‡è®¿é—®å®ƒå»æœç´¢åˆ°å¯¹æ–¹çš„å¤–ç½‘IPå’Œç«¯å£å·ä¿¡æ¯ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥å°†è‡ªå·±çš„å¤–ç½‘IPå’Œç«¯å£å·ä¿¡æ¯ç»™æ³¨å†Œåˆ°ä¸Šé¢ã€‚æ‰€ä»¥è¿™é‡Œç”²ã€ä¹™èƒ½å¤Ÿåœ¨é€šä¿¡å‰å°±çŸ¥é“å½¼æ­¤çš„é€šä¿¡åœ°å€ä¿¡æ¯ã€‚<p><strong>å¦‚æœç”²çš„ NAT ç±»å‹æ˜¯ A ï¼š</strong><ul><li>æ— è®ºä¹™çš„ç±»å‹æ˜¯ A/B/C/Dï¼Œä¹™éƒ½èƒ½å¤Ÿç›´æ¥å‘ç”²çš„ eAddr:port å‘é€æ•°æ®ï¼Œè€Œå½“ç”²å·²ç»æ”¶åˆ°ä¹™çš„æ•°æ®æ—¶ï¼Œä¹Ÿèƒ½å¤Ÿè·å¾—åˆ°ä¹™çš„ eAddr2:port2ï¼Œä»¥åŠå‘ä¹™å‘é€æ•°æ®çš„èµ„æ ¼ï¼Œä»è€Œå»ºç«‹åŒå‘é€šä¿¡ã€‚</ul><p><strong>å¦‚æœç”²çš„ NAT ç±»å‹æ˜¯ B ï¼š</strong><ul><li>å½“ä¹™çš„ NAT ç±»å‹æ˜¯ B/C/D ï¼šç”²å…ˆä½¿ç”¨ <code>192.168.1.1:10001</code> => <code>1.1.1.1:10002(ç”²å¤–ç½‘å‡ºå£)</code> => <code>2.2.2.2:20002(ä¹™å¤–ç½‘å…¥å£)</code> å‘ä¹™å°è¯•å‘é€æ•°æ®ï¼Œè™½è¢«ä¹™æ‹’ç»ï¼Œä½†åœ¨ä¹™çš„è·¯ç”±å™¨ä¸Šç•™ä¸‹äº†è®¿é—®è®°å½•ï¼Œä»è€Œä½¿å¾—ä¹™å…·å¤‡äº†å‘ç”²å‘é€æ•°æ®çš„èƒ½åŠ›ã€‚è€Œå½“ä¹™å‘é€å®Œæ•°æ®ï¼Œåˆä¼šä½¿å¾—ç”²è·å¾—å‘ä¹™å‘é€æ•°æ®çš„èƒ½åŠ›ï¼Œä»è€Œå»ºç«‹åŒå‘é€šä¿¡ã€‚<li>å½“ä¹™çš„ NAT ç±»å‹æ˜¯ A æ—¶åŒä¸Šç”²ä¸º A æ—¶é€»è¾‘</ul><p><strong>å¦‚æœç”²çš„ NAT ç±»å‹æ˜¯ C ï¼š</strong><ul><li>å½“ä¹™çš„ NAT ç±»å‹æ˜¯ D ï¼šä¹™å°è¯•è¿æ¥ç”²çš„æ—¶å€™ä¼šè¢«æ‹’ç»ï¼Œå¹¶ä¸”ç”²ä¹Ÿæ²¡æ³•çŸ¥é“ä¹™æ˜ å°„çš„ç«¯å£å·æ˜¯å“ªä¸€ä¸ªæ‰€ä»¥äº¦æ— æ³•è¿æ¥åˆ°ä¹™ã€‚æ— æ³•å»ºç«‹ä»»ä¸€æ–¹å‘çš„é€šä¿¡ã€‚<li>å½“ä¹™çš„ NAT ç±»å‹æ˜¯ B ï¼šC-B çš„è¿æ¥åŒä¸Šé¢ B-C çš„è¿æ¥ã€‚<li>å½“ä¹™çš„ NAT ç±»å‹æ˜¯ C ï¼šC-C å’Œ C-B/B-C çš„åŒºåˆ«ä»…åœ¨äºè¦æ±‚åŒæ–¹å‡ºå£çš„ç«¯å£è¦ä¸€ç›´ä¿æŒä¸€è‡´ï¼Œè¦æ±‚æ›´åŠ ä¸¥æ ¼ï¼Œä½†ä¾æ—§èƒ½å¤Ÿå»ºç«‹åŒå‘é€šä¿¡ã€‚<li>å½“ä¹™çš„ NAT ç±»å‹æ˜¯ A æ—¶äº¦èƒ½å¤Ÿå»ºç«‹åŒå‘é€šä¿¡ã€‚</ul><p><strong>å¦‚æœç”²çš„ NAT ç±»å‹æ˜¯ D ï¼š</strong><ul><li>å½“ä¹™çš„ NAT ç±»å‹æ˜¯ Dï¼šæ— æ³•å»ºç«‹ä»»ä¸€æ–¹å‘çš„é€šä¿¡ã€‚<li>å½“ä¹™çš„ NAT ç±»å‹æ˜¯ Cï¼šåŒ C-Dï¼Œæ— æ³•å»ºç«‹ä»»ä¸€æ–¹å‘çš„é€šä¿¡ã€‚<li>å½“ä¹™çš„ NAT ç±»å‹æ˜¯ A/Bï¼šåŒ A-D å’Œ B-Dï¼Œèƒ½å¤Ÿå»ºç«‹åŒå‘é€šä¿¡ã€‚</ul><p>ç»¼ä¸Šæ¨å¯¼ï¼Œå¯ä»¥æœ‰ä»¥ä¸‹ç»“è®ºï¼š<ol><li>åªæœ‰ C-D,D-C,D-D çš„ç»„åˆæ˜¯æ²¡æœ‰æœºä¼šèƒ½å¤Ÿå»ºç«‹åŒå‘é€šä¿¡çš„ï¼Œå…¶ä»–ç»„åˆåœ¨ NAT å±‚é¢ä¸Šéƒ½èƒ½å¤Ÿå…·å¤‡åŒå‘é€šä¿¡çš„èƒ½åŠ›ã€‚<li>ç±»å‹ä¸º A/B çš„ç©å®¶ç†è®ºä¸Šè¿å…¶ä»–ä»»ä½•ç±»å‹çš„ç©å®¶éƒ½ä¸ä¼šæœ‰ NAT ä¸Šçš„é—®é¢˜ã€‚</ol><p>å½“ç„¶ä¸Šè¿°éƒ½æ˜¯ç†è®ºï¼Œå®é™…ä¸­æ˜¯å¦çœŸçš„èƒ½å¤Ÿè¿æ¥ä¸Šè¿˜å–å†³äºå…¶ä»–ç½‘ç»œçŠ¶å†µç”šè‡³æ˜¯ç¨‹åºç¼–å†™é€»è¾‘çš„å› ç´ ã€‚<h2 id=åŠ¨æ£®æ˜¯å¦‚ä½•åšè”æœºçš„>åŠ¨æ£®æ˜¯å¦‚ä½•åšè”æœºçš„</h2><p>è®¸å¤šä¸»æœºæ¸¸æˆåœ¨è”æœºçš„æ—¶å€™éƒ½ä¼šæœ‰ä¸€äº›åœ¨ç©å®¶çœ‹æ¥éå¸¸å¥‡æ€ªç”šè‡³å¥‡è‘©çš„è®¾å®šï¼Œè¿™äº›è®¾å®šéƒ½å’Œä¸Šé¢è®²çš„åŒæ­¥æœºåˆ¶å’Œè”æœºç½‘ç»œé—®é¢˜ç›¸å…³ã€‚<p>åŠ¨æ£®çš„è”æœºæ¨¡å¼ä¹Ÿæœ‰è¯¸å¤šæœ‰æ„æ€(æ¼äºº)çš„è®¾å®šï¼Œä¾‹å¦‚ï¼š<ul><li>è”æœºçŠ¶æ€ä¸‹æ— æ³•æ›´æ”¹å²›çš„è£…é¥°<li>å½“ä¸€ä¸ªç©å®¶ä¸Šå²›æ—¶ï¼Œä¼šéœ€è¦æ‰€æœ‰äººæš‚åœè¿‘å¾ˆé•¿æ—¶é—´æ¥ç­‰å…¶æˆåŠŸåŠ å…¥<li>å½“ä¸€ä¸ªç©å®¶ç¦»å¼€æ—¶ï¼ŒåŒæ ·éœ€è¦å¤§å®¶åŒæ­¥ç›®é€å…¶ç¦»å¼€ï¼Œå¹¶ä¸”åœ¨ç¦»å¼€æ—¶ä¼šä¿å­˜å½“å‰æ—¶åˆ»çš„æ•°æ®è¿›åº¦<li>å½“æœ‰ä¸ªç©å®¶æ‰çº¿/å¼ºè¡Œé€€å‡ºæ—¶ï¼Œæ‰€æœ‰äººçš„æ•°æ®ä¼šå›æ»šå²›ä¸Šä¸€æ¬¡ç©å®¶ç™»å²›/æ­£å¸¸ç¦»å¼€æ—¶çš„ç‰ˆæœ¬<li>å½“å²›å†…æœ‰ç©å®¶æ‰“å¼€äº†å¯¹è¯çª—å£æ—¶ï¼Œäººä¸èƒ½æ­£å¸¸ç¦»å¼€ä¹Ÿä¸èƒ½ä¸Šå²›</ul><p>ä»¥ä¸‹åˆ†æä»…ä»…æ˜¯æˆ‘åœ¨ç©äº† 200 ä¸ªå°æ—¶æ¸¸æˆåï¼Œç»“åˆè‡ªå·±çš„è½¯ä»¶å·¥ç¨‹ç»éªŒå¯¹åŠ¨æ£®å®ç°æ–¹å¼çš„çŒœæµ‹ã€‚åœ¨æ²¡æœ‰çœ‹ä»£ç å‰è°ä¹Ÿæ— æ³•ä¿è¯è¿™ç§çŒœæµ‹çš„ç»å¯¹æ­£ç¡®æ€§ï¼Œå†µä¸”ç›¸æ¯”æ­£ç¡®æ€§ï¼Œæˆ‘æ›´åœ¨ä¹è¿™ä¸ªçŒœæµ‹è¿‡ç¨‹çš„å¼€å¿ƒï¼Œæ‰€ä»¥å¤§å®¶å¯ä»¥æ›´å¤šä»¥å·¥ç¨‹è§’åº¦æ¥æ€è€ƒè€Œä¸æ˜¯çº ç»“äºå…¶æ˜¯å¦çš„ç¡®æ˜¯è¿™ä¹ˆå®ç°çš„ã€‚<p>æˆ‘ä»¬å¯ä»¥æŠŠè”æœºæ¸¸æˆçš„è¿‡ç¨‹åˆ†ä»¥ä¸‹å‡ ä¸ªç¯èŠ‚æ¥åˆ†åˆ«è®¨è®ºï¼š<h3 id=1-ç”²æ‰“å¼€è”æœºæƒé™å³æ‰€è°“çš„å¼€é—¨ç”¨è‡ªå·±ä¸»æœºä½œä¸º-host>1. ç”²æ‰“å¼€è”æœºæƒé™(å³æ‰€è°“çš„å¼€é—¨)ï¼Œç”¨è‡ªå·±ä¸»æœºä½œä¸º Host</h3><p>è¿™ä¸€æ­¥ç”²å°†è‡ªå·±çš„å¤–ç½‘ IP å’Œç«¯å£å·(å¦‚ <code>1.1.1.1:10001</code>)æ³¨å†Œåœ¨äº† Switch çš„è”æœºæœåŠ¡ä¸­ã€‚<h3 id=2-ä¹™é€šè¿‡æœç´¢æ‰¾åˆ°ç”²å°è¯•åŠ å…¥>2. ä¹™é€šè¿‡æœç´¢æ‰¾åˆ°ç”²ï¼Œå°è¯•åŠ å…¥</h3><ul><li><p>ä¹™é€šè¿‡è”æœºæœåŠ¡å…ˆå°†è‡ªå·±çš„å¤–ç½‘ IP å’Œç«¯å£å·(å¦‚ <code>2.2.2.2:10002</code>)æ³¨å†Œä¸Šå»ã€‚(å³æ¸¸æˆé‡Œè¯¢é—®æ˜¯å¦è¦è”æœºçš„é‚£ä¸€æ­¥)<li><p>å†é€šè¿‡æœç´¢å¾—åˆ°ç”²çš„ <code>1.1.1.1:10001</code> (å³åŠ¨æ£®é‡Œæœç´¢å¥½å‹çš„é‚£ä¸€æ­¥)ï¼Œå°è¯•è¿æ¥ã€‚<p>æ³¨æ„ï¼Œæ­¤æ—¶ç”²ä¸»æœºåœ¨åå°ä¹Ÿé€šè¿‡è”æœºæœåŠ¡çŸ¥é“äº†ä¹™åœ¨è¿å®ƒï¼Œå¹¶ä¸”ç”²ä¹Ÿä¼šæ ¹æ® NAT ç±»å‹çš„ä¸åŒï¼Œç”¨ä¹™çš„ <code>2.2.2.2:10002</code> å»è¿ä¹™ï¼Œå°è¯•æ‰“é€šåŒå‘é€šä¿¡ã€‚</ul><h3 id=3-å»ºç«‹è¿æ¥ä¸Šå²›>3. å»ºç«‹è¿æ¥ï¼Œä¸Šå²›</h3><p>å½“ä¸Šé¢ä¸€æ­¥ç¡®è®¤èƒ½å¤Ÿå»ºç«‹åŒå‘é€šè®¯åï¼Œå°±å¯ä»¥å¼€å§‹ä¸Šå²›äº†ã€‚ä¸Šå²›åˆåˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š<h4 id=31-host-æ‰“åŒ…å½“å‰æ‰€æœ‰æ¸¸æˆçŠ¶æ€>3.1 Host æ‰“åŒ…å½“å‰æ‰€æœ‰æ¸¸æˆçŠ¶æ€</h4><p>åœ¨ä¸Šå²›å‰ï¼Œç”²ä¸»æœº(Host)ä¼šæŠŠå½“å‰æ—¶åˆ»çš„æ‰€æœ‰äººçš„æ¸¸æˆæ•°æ®ç»™æ‰“åŒ…ä¸€ä»½ snapshotã€‚<p>è¿™é‡Œçš„ snapshot æ•°æ®å†…å®¹åŒ…æ‹¬å²›å±¿æ•°æ®å’Œç©å®¶æ•°æ®ã€‚<h4 id=32-ä¸‹è½½å¯¹æ–¹å²›çš„-snapshot>3.2 ä¸‹è½½å¯¹æ–¹å²›çš„ snapshot</h4><p>åŠ¨æ£®ä¸Šå²›æ—¶ä¼šå¼¹å‡ºä¸€ä¸ªæ˜¾ç¤ºè¿›åº¦çš„åŠ¨ç”»ï¼Œè¿™ä¸ªåŠ¨ç”»çš„è¿‡ç¨‹å°±æ˜¯åœ¨ä¸‹è½½ç›®æ ‡å²›çš„ snapshot æ•°æ®ï¼Œå¾ˆæ˜æ˜¾èƒ½å¤Ÿå‘ç°å¦‚æœåœ¨ä¸­å›½è¿ç¾å›½çš„ç©å®¶ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šéå¸¸æ¼«é•¿ï¼Œè¿™ä¸ªæ˜¯ç”±äºè·¨å¢ƒç½‘é€Ÿæ…¢å¯¼è‡´çš„ã€‚<h4 id=33-å…¶ä»–äººåŒæ­¥ç­‰å¾…ç›´åˆ°æ–°ç©å®¶ä¸Šå²›>3.3 å…¶ä»–äººåŒæ­¥ç­‰å¾…ï¼Œç›´åˆ°æ–°ç©å®¶ä¸Šå²›</h4><p>ä¹‹æ‰€ä»¥å…¶ä»–ç©å®¶è¦ç­‰å¾…æ–°ç©å®¶ä¸Šå²›æ˜¯å› ä¸ºä¸Šä¸€æ­¥ä¿å­˜çš„ snapshot å¿…é¡»æ˜¯æœ€æ–°çš„ç»“æœï¼Œè¿™ä¹Ÿæ„å‘³ç€å…¶ä»–ç©å®¶ä¸èƒ½å†æœ‰å¢é‡æ“ä½œï¼Œå¦åˆ™æ–°ç©å®¶ä¸Šå²›æ—¶çŠ¶æ€å°±ä¸ä¸€è‡´äº†ã€‚<h3 id=4-å¼€å§‹æ¸¸æˆ>4. å¼€å§‹æ¸¸æˆ</h3><p>å½“ä¸Šå²›å®Œæ¯•ï¼Œå°±å¯ä»¥å¼€å§‹æ­£å¸¸å¼€å§‹æ¸¸æˆäº†ã€‚è¿™æ—¶å€™å°±ä¼šé‡åˆ°ä¸€ä¸ªå¦‚ä½•åŒæ­¥ç©å®¶å½¼æ­¤æ“ä½œæ•°æ®çš„é—®é¢˜ã€‚<p>è¿™é‡Œæˆ‘ä»¬æŠŠç©å®¶çš„æ“ä½œåˆ†ä¸ºä¸¤ç§ç±»å‹ï¼š<ol><li>å½±å“æ¸¸æˆæ•°æ®ï¼ˆä½é¢‘ï¼Œæœ‰æ—¶åºè¦æ±‚ï¼Œéœ€è¦è½ç›˜ï¼‰<li>å½±å“æ¸¸æˆç”»é¢ä½†ä¸å½±å“æ¸¸æˆæ•°æ®ï¼ˆé«˜é¢‘ï¼Œæ— æ—¶åºè¦æ±‚ï¼Œä¸éœ€è¦è½ç›˜ï¼‰</ol><p>å¦‚æœä»”ç»†ä½“éªŒä¼šå‘ç°ï¼Œå½“æˆ‘ä»¬åœ¨æŒ–å‘ã€å’Œ NPC å¯¹è¯ã€ä¸¢ç‰©å“ç­‰ä¼šå¯¹å…¨å±€æ¸¸æˆæ•°æ®äº§ç”Ÿç›´æ¥å½±å“çš„æ“ä½œæ—¶ï¼Œå¶å°”ä¼šå‡ºç°ä¸€ä¸‹å¡é¡¿ï¼Œè¿™æ˜¯å› ä¸ºè¿™äº›ä¼šå½±å“å…¨å±€çŠ¶æ€çš„æ“ä½œåœ¨æ¸²æŸ“ç”»é¢å‰éƒ½éœ€è¦å…ˆå‘ Host ä¸»æœºè¯·æ±‚æ˜¯å¦å…è®¸ï¼Œè¿™é‡Œå¦‚æœå‡ºç°ç½‘ç»œæŠ–åŠ¨çš„è¯å°±ä¼šå‡ºç°å¡é¡¿/å¤±è´¥çš„æƒ…å†µã€‚ä½†æ˜¯æˆ‘ä»¬è·‘æ­¥çš„æ—¶å€™å´å¾ˆå°‘å‡ºç°å¡é¡¿ï¼Œä½†æœ‰æ—¶ä¼šå‡ºç°ã€Œé—ªå›ã€ï¼Œå› ä¸ºè·‘åŠ¨åªå½±å“äº†ç©å®¶å½“å‰ä½ç½®ï¼Œä¸å½±å“æ¸¸æˆæ•°æ®ï¼Œå°±ç®—å‡ºç°é—ªå›ä¹Ÿæ˜¯èƒ½å¤Ÿæ¥å—çš„ï¼Œè€Œä¸”è¿˜ä¸éœ€è¦å¼ºåˆ¶ä¿è¯æ—¶åºæ€§ã€‚å†µä¸”å¦‚æœè·‘æ­¥ä¹Ÿè¦å» Host ç«¯è¯¢é—®å°±ä¼šå¯¼è‡´æ•´ä¸ªæ¸¸æˆä½“éªŒéƒ½éå¸¸å¡ã€‚ä½†æ˜¯åƒä¸¢ç‰©å“è¿™ç§æ“ä½œå¦‚æœæ•°æ®é”™ä¹±æˆ–è€…æ—¶åºé”™ä¹±çš„è¯ï¼Œæ•´ä¸ªçŠ¶æ€å°±ä¸ä¸€è‡´äº†ï¼Œä¼šéå¸¸ä¸¥é‡ã€‚<p>æ‰€ä»¥è¿™é‡Œçš„åŒæ­¥æ–¹å¼å…¶å®æ˜¯é”æ­¥åŒæ­¥ã€‚åªä¸è¿‡åˆ†åˆ«å¯¹ä½é¢‘å’Œé«˜é¢‘åšäº†åˆ†åˆ«çš„ç­–ç•¥ã€‚<h3 id=5-ç©å®¶é€€å‡ºå¼ºé€€æ‰çº¿>5. ç©å®¶é€€å‡º/å¼ºé€€/æ‰çº¿</h3><p>ç©å®¶å¦‚æœæ­£å¸¸é€€å‡ºæ¸¸æˆï¼Œä¼šè§¦å‘ä¸€ä¸ªã€Œä¿å­˜æ•°æ®ã€ç•Œé¢ã€‚è¦ç†è§£è¿™ä¸ªä¿å­˜æ•°æ®çš„å«ä¹‰ï¼Œæˆ‘ä»¬è¦æŠŠæ¸¸æˆé‡Œçš„æ•°æ®åˆ†ä¸ºä¸¤ç±»ï¼š<ol><li>å²›å±¿çš„çŠ¶æ€<li>æ¯ä¸ªç©å®¶çš„æ¯ä¸€æ­¥æ“ä½œæ•°æ®</ol><p>é¦–å…ˆå¯¹äºä¸»æœºæ¸¸æˆæ¥è¯´ï¼Œå…¶çœŸæ­£æœ‰æ•ˆçš„æ•°æ®éƒ½æ˜¯è¦æœ€ç»ˆè½ç›˜åˆ°ä¸»æœºæœ¬åœ°å­˜å‚¨é‡Œã€‚ä½†è¯•æƒ³å¦‚æœæ¯ä¸€æ¬¡æ›´æ–°éƒ½è§¦å‘ç©å®¶æœ¬åœ°ä¸»æœºå­˜å‚¨çš„æ›´æ–°ï¼Œåˆ°æ—¶å€™è¦å›æ»šèµ·æ¥ä¹Ÿä¼šå˜å¾—å¼‚å¸¸éº»çƒ¦ï¼Œæ›´ä¸ç”¨è¯´ç£ç›˜çš„ IO è¿˜éå¸¸æ…¢ã€‚æ‰€ä»¥è¿™é‡Œæ›´å¯èƒ½çš„å®ç°æ–¹å¼å…¶å®æ˜¯ï¼ŒHost ä¸»æœºçš„å†…å­˜é‡Œå­˜æ”¾ç€å½“å‰æ¸¸æˆçš„æƒå¨æ•°æ®ï¼ŒåŒ…æ‹¬å²›å±¿çŠ¶æ€å’Œç©å®¶æ“ä½œã€‚å¦å¤–ï¼Œæ— è®ºç©å®¶ç”¨ä»€ä¹ˆæ–¹å¼é€€å‡ºï¼Œæˆ‘ä»¬éƒ½å¿…é¡»ç¡®ä¿ç»“æŸæ¸¸æˆåï¼Œæ‰€æœ‰ç©å®¶æœ¬åœ°çš„å­˜æ¡£åŠ ä¸Š Host ä¸»æœºä¸Šçš„å­˜æ¡£éƒ½æ˜¯æŸä¸€ä¸ªæ—¶é—´ç‚¹ä¸Šçš„çœŸæ­£æ¸¸æˆçŠ¶æ€ã€‚æ¸¸æˆæ•°æ®çš„æ­£ç¡®æ€§ä¼˜å…ˆçº§æ˜¯é«˜äºç”¨æˆ·ä½“éªŒçš„ã€‚ä¸‹é¢ä¼šæœ‰ä¾‹å­æ¥è§£é‡Šè¿™ç‚¹çš„é‡è¦æ€§ã€‚<p>å½“ç©å®¶æ­£å¸¸é€€å‡ºè§¦å‘ã€Œä¿å­˜æ•°æ®ã€æ—¶ï¼ŒHost ä¸»æœºé¦–å…ˆä¼šå¼€å¯ä¸€ä¸ªå½“å‰æ—¶åˆ»çš„ snapshotï¼Œç„¶åæ¯ä¸ªç©å®¶çš„ä¸»æœºéƒ½ä¼šå‘ Host ä¸»æœºå»ä¸‹è½½å±äºå…¶çš„æ“ä½œæ•°æ®ï¼Œå¹¶è½ç›˜åˆ°æœ¬åœ°ã€‚<p>ä½†å½“æœ‰ç©å®¶å¼‚å¸¸é€€å‡ºæ—¶ï¼Œç”±äºå…¶å¹¶æ²¡æœ‰ä¸‹è½½å±äºä»–çš„æ•°æ®ï¼Œæ‰€ä»¥ä»–çš„æœ¬åœ°æ¸¸æˆæ•°æ®è¿˜åœç•™åœ¨ä¸Šä¸€æ¬¡ä¿å­˜çš„æ—¶é—´ç‚¹ T1 ä¸Šï¼Œä¸ºäº†æ»¡è¶³æˆ‘ä»¬å‰é¢è¯´çš„æ•°æ®æ­£ç¡®æ€§çš„ä¿è¯ï¼Œè™½ç„¶å²›ä¸Šå…¶ä»–ç©å®¶æ²¡æœ‰æ‰çº¿ï¼Œå¹¶ä¸”ä»–ä»¬æ¸¸æˆé‡Œçš„çŠ¶æ€éƒ½æ˜¯æœ€æ–°çš„ä¹Ÿæ˜¯æ­£ç¡®çš„æ•°æ®ï¼Œä½†ä¸å¾—ä¸ä¸ºäº†è®©è¿™ä¸ªå®¶ä¼™çš„æ•°æ®æ˜¯æ­£ç¡®çš„è€ŒæŠŠå…¶ä»–æ‰€æœ‰äººçš„æ•°æ®éƒ½å›æ»šåˆ°äº†æ—¶é—´ T1 ä¸Šï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆåŠ¨æ£®ä¼šå‡ºç°æ‰çº¿å›æ¡£çš„åŸå› ã€‚<h2 id=å¸¸è§é—®é¢˜>å¸¸è§é—®é¢˜</h2><h3 id=ä»»å¤©å ‚è”æœºæœåŠ¡åƒåœ¾å—>ä»»å¤©å ‚è”æœºæœåŠ¡åƒåœ¾å—ï¼Ÿ</h3><p>é€šè¿‡ä¸Šé¢çš„è§£é‡Šèƒ½å¤Ÿç†è§£ï¼Œè¿™äº›çœ‹ä¼¼å¥‡è‘©çš„è”æœºä½“éªŒèƒŒåï¼Œçš„ç¡®æ˜¯æœ‰ç€éå¸¸å¤šæŠ€æœ¯éš¾é¢˜çš„ã€‚è€Œä¸”ä»»å¤©å ‚æ¯•ç«Ÿæ˜¯ä¸€å®¶æ¸¸æˆå…¬å¸ä¸æ˜¯ä¸“ä¸šåˆ†å¸ƒå¼æ•°æ®åº“å…¬å¸ï¼Œè™½ç„¶ç›®å‰çš„æŠ€æœ¯å®ç°æ–¹æ¡ˆæœ‰è¯¸å¤šå¯ä»¥æ”¹è¿›çš„åœ°æ–¹ï¼Œä½†æ˜¯ä¹Ÿæ˜¯è¦ç®—ä¸Š ROI çš„ï¼Œæ‰€ä»¥è°ˆã€Œåƒåœ¾ã€è¿˜æ˜¯ç®—ä¸ä¸Šã€‚<h3 id=ä¸ºä»€ä¹ˆæ¸¸æˆå‚å•†ä¸è‡ªå»ºæœåŠ¡å™¨æ¥æå‡ä½“éªŒ>ä¸ºä»€ä¹ˆæ¸¸æˆå‚å•†ä¸è‡ªå»ºæœåŠ¡å™¨æ¥æå‡ä½“éªŒï¼Ÿ</h3><p>æ¸¸æˆç©å®¶æ¥è‡ªå…¨çƒå„åœ°ï¼Œå¦‚æœè¦ç”¨è‡ªå»ºæœåŠ¡å™¨æ¥æå‡ä½“éªŒï¼Œé‚£ä¹Ÿå¾—åœ¨å…¨çƒéƒ½é“ºè®¾æœåŠ¡å™¨ï¼Œè¿™ä¸ªæˆæœ¬ç›¸å½“å¤§ä¸”å®ç°éš¾åº¦ä¹Ÿç›¸å½“å¤§çš„ã€‚çš„ç¡®ç°åœ¨ä¼šæœ‰é‚£ç§å…¨çƒåŒæœçš„è§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯ä¸€èˆ¬éƒ½æ˜¯åƒç½‘ç»œæ¸¸æˆè¿™ç§å°±é ç€è”ç½‘æ¥æŒ£é’±çš„å…¬å¸ä¼šæœ‰èƒ½åŠ›å’Œæ„æ„¿é‡‡ç”¨ã€‚ä¸»æœºæ¸¸æˆçš„å•†ä¸šæ¨¡å¼æ³¨å®šäº†ä»–ä»¬ä¸ä¼šèŠ±éå¸¸é«˜çš„æˆæœ¬å»æå‡ç½‘ç»œä½“éªŒã€‚å½“ç„¶ä¸»æœºç”Ÿäº§å•†è‡ªå·±æä¸€ä¸ªå…¨çƒæœåŠ¡å™¨å°±æ˜¯å¦è¯´äº†ã€‚<h2 id=å‚è€ƒèµ„æ–™>å‚è€ƒèµ„æ–™</h2><ul><li><a href=https://en.wikipedia.org/wiki/Network_address_translation>Wikipedia: Network address translation</a><li><a href=http://midcom-p2p.sourceforge.net/draft-ford-midcom-p2p-01.txt>Peer-to-Peer (P2P) communication across middleboxes</a><li><a href=https://zhuanlan.zhihu.com/p/56923109>ç½‘ç»œæ¸¸æˆåŒæ­¥æŠ€æœ¯æ¦‚è¿°</a></ul></div><div class="row middle-xs"><div class=col-xs-12></div></div><div class=row><div class=col-xs-12><br><br><p>Subscribeï¼š<a target=_blank href=https://mailchi.mp/a1a0d59e7a19/joway><b>Mailchimp</b></a></p><br><a rel=license href=http://creativecommons.org/licenses/by-nc-nd/4.0/><img alt="Creative Commons License" style=border-width:0 src=https://blog.joway.io/images/cc.png></a></div></div><div style=height:50px></div><div class=post-comments><div id=disqus_thread></div><script>window.addEventListener("load",()=>{(function(){var e=document,t=e.createElement("script");t.src="https://joway.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()})</script><noscript>Please enable JavaScript to view the
<a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div><div class=site-footer></div></div></div></article><script src=https://cdn.jsdelivr.net/gh/joway/blog/js/lazyload.min.js></script><script>var lazyImage=new LazyLoad({container:document.getElementById("article")})</script><script>document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("disqus_thread");if(!e)return;const t=new MutationObserver(function(n){n.forEach(function(){const n=e.getElementsByTagName("iframe");if(n.length>1){const s=n[1];for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(s),t.disconnect()}})});t.observe(e,{childList:!0,subtree:!0})})</script>