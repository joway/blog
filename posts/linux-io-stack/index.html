<!doctype html><html lang=en><meta charset=utf-8><meta name=generator content="Hugo 0.148.2"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Joway"><meta property="og:url" content="https://blog.joway.io/posts/linux-io-stack/"><link rel=canonical href=https://blog.joway.io/posts/linux-io-stack/><link rel=dns-prefetch href=https://cdn.jsdelivr.net/gh/joway/blog><link rel=apple-touch-icon href=/logo.png><link rel=icon href=/logo.png><link rel=shortcut href=/logo.png><link rel=alternate type=application/atom+xml href=https://blog.joway.io/index.xml title="Random Thoughts"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.joway.io\/"},"articleSection":"posts","name":"Linux I\/O æ ˆæµ…æ","headline":"Linux I\/O æ ˆæµ…æ","description":"åœ¨ Linux ä¸­ï¼Œæ‰€æœ‰å¤–éƒ¨èµ„æºéƒ½ä»¥æ–‡ä»¶å½¢å¼ä½œä¸ºä¸€ä¸ªæŠ½è±¡è§†å›¾ï¼Œå¹¶æä¾›ä¸€å¥—ç»Ÿä¸€çš„æ¥å£ç»™åº”ç”¨ç¨‹åºè°ƒç”¨ã€‚æœ¬æ–‡å°†ä»¥å®è§‚è§†è§’è¯•å›¾é˜è¿° Linux ä¸­å…³äºæ–‡ä»¶ IO çš„æ•´ä¸ªè°ƒç”¨è„‰ç»œã€‚\nVFS åœ¨ Linux ä¸­ï¼Œæ‰€æœ‰ IO éƒ½å¿…é¡»å…ˆç»ç”± VFS å±‚è¿›è¡Œè½¬å‘ã€‚é€šè¿‡ VFS å°†åŒ…æ‹¬ç£ç›˜ã€ç½‘ç»œ Socketã€æ‰“å°æœºã€ç®¡é“ç­‰èµ„æºå…¨éƒ¨å°è£…æˆç»Ÿä¸€çš„æ¥å£ã€‚\nåŸºç¡€ç»“æ„ VFS è‡ªé¡¶å‘ä¸‹ä½¿ç”¨å››ä¸ªæ•°æ®ç»“æ„æ¥æè¿°æ–‡ä»¶ï¼š\nfile: å­˜æ”¾ä¸€ä¸ªæ–‡ä»¶å¯¹è±¡çš„ä¿¡æ¯ã€‚ struct file { union { struct llist_node fu_llist; struct rcu_head fu_rcuhead; } f_u; struct path f_path; struct inode *f_inode; \/* cached value *\/ const struct file_operations *f_op; struct mutex f_pos_lock; loff_t f_pos; } dentry: å­˜æ”¾ç›®å½•é¡¹å’Œå…¶ä¸‹çš„æ–‡ä»¶é“¾æ¥ä¿¡æ¯ã€‚ struct dentry { unsigned int d_flags; seqcount_t d_seq; struct hlist_bl_node d_hash; \/* å“ˆå¸Œé“¾è¡¨ *\/ struct dentry *d_parent; \/* çˆ¶ç›®å½•é¡¹ *\/ struct qstr d_name; \/* ç›®å½•å *\/ struct inode *d_inode; \/* å¯¹åº”çš„ç´¢å¼•èŠ‚ç‚¹ *\/ unsigned char d_iname[DNAME_INLINE_LEN]; \/* small names *\/ struct lockref d_lockref; \/* per-dentry lock and refcount *\/ const struct dentry_operations *d_op; \/* dentryæ“ä½œ *\/ struct super_block *d_sb; \/* æ–‡ä»¶çš„è¶…çº§å—å¯¹è±¡ *\/ unsigned long d_time; void *d_fsdata; struct list_head d_lru; \/* LRU list *\/ struct list_head d_child; \/* child of parent list *\/ struct list_head d_subdirs; \/* our children *\/ union { struct hlist_node d_alias; \/* inode alias list *\/ struct rcu_head d_rcu; } d_u; } inode: ç´¢å¼•èŠ‚ç‚¹å¯¹è±¡ï¼Œå­˜åœ¨å…·ä½“æ–‡ä»¶çš„ä¸€èˆ¬ä¿¡æ¯ï¼Œæ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶çš„å”¯ä¸€æ ‡è¯†ã€‚ struct inode { struct hlist_node i_hash; \/* æ•£åˆ—è¡¨ï¼Œç”¨äºå¿«é€ŸæŸ¥æ‰¾inode *\/ struct list_head i_list; \/* ç›¸åŒçŠ¶æ€ç´¢å¼•èŠ‚ç‚¹é“¾è¡¨ *\/ struct list_head i_sb_list; \/* æ–‡ä»¶ç³»ç»Ÿä¸­æ‰€æœ‰èŠ‚ç‚¹é“¾è¡¨ *\/ struct list_head i_dentry; \/* ç›®å½•é¡¹é“¾è¡¨ *\/ unsigned long i_ino; \/* èŠ‚ç‚¹å· *\/ atomic_t i_count; \/* å¼•ç”¨è®¡æ•° *\/ unsigned int i_nlink; \/* ç¡¬é“¾æ¥æ•° *\/ uid_t i_uid; \/* ä½¿ç”¨è€…id *\/ gid_t i_gid; \/* ä½¿ç”¨ç»„id *\/ struct timespec i_atime; \/* æœ€åè®¿é—®æ—¶é—´ *\/ struct timespec i_mtime; \/* æœ€åä¿®æ”¹æ—¶é—´ *\/ struct timespec i_ctime; \/* æœ€åæ”¹å˜æ—¶é—´ *\/ const struct inode_operations *i_op; \/* ç´¢å¼•èŠ‚ç‚¹æ“ä½œå‡½æ•° *\/ const struct file_operations *i_fop; \/* ç¼ºçœçš„ç´¢å¼•èŠ‚ç‚¹æ“ä½œ *\/ struct super_block *i_sb; \/* ç›¸å…³çš„è¶…çº§å— *\/ struct address_space *i_mapping; \/* ç›¸å…³çš„åœ°å€æ˜ å°„ *\/ struct address_space i_data; \/* è®¾å¤‡åœ°å€æ˜ å°„ *\/ unsigned int i_flags; \/* æ–‡ä»¶ç³»ç»Ÿæ ‡å¿— *\/ void *i_private; \/* fs ç§æœ‰æŒ‡é’ˆ *\/ unsigned long i_state; }; superblock: è¶…çº§å—å¯¹è±¡ï¼Œè®°å½•è¯¥æ–‡ä»¶ç³»ç»Ÿçš„æ•´ä½“ä¿¡æ¯ã€‚åœ¨æ–‡ä»¶ç³»ç»Ÿå®‰è£…æ—¶å»ºç«‹ï¼Œåœ¨æ–‡ä»¶ç³»ç»Ÿå¸è½½æ—¶åˆ é™¤ã€‚ é“¾æ¥ ç¡¬é“¾æ¥ VS è½¯é“¾æ¥:\n","inLanguage":"en-US","author":"Joway","creator":"Joway","publisher":"Joway","accountablePerson":"Joway","copyrightHolder":"Joway","copyrightYear":"2019","datePublished":"2019-08-11 00:00:00 \u002b0000 UTC","dateModified":"2019-08-11 00:00:00 \u002b0000 UTC","url":"https:\/\/blog.joway.io\/posts\/linux-io-stack\/","keywords":[]}</script><title>Linux I/O æ ˆæµ…æ</title><meta property="og:title" content="Linux I/O æ ˆæµ…æ"><meta property="og:type" content="article"><meta property="og:description" content="åœ¨ Linux ä¸­ï¼Œæ‰€æœ‰å¤–éƒ¨èµ„æºéƒ½ä»¥æ–‡ä»¶å½¢å¼ä½œä¸ºä¸€ä¸ªæŠ½è±¡è§†å›¾ï¼Œå¹¶æä¾›ä¸€å¥—ç»Ÿä¸€çš„æ¥å£ç»™åº”ç”¨ç¨‹åºè°ƒç”¨ã€‚æœ¬æ–‡å°†ä»¥å®è§‚è§†è§’è¯•å›¾é˜è¿° Linux ä¸­å…³äºæ–‡ä»¶ IO çš„æ•´ä¸ªè°ƒç”¨è„‰ç»œã€‚
VFS åœ¨ Linux ä¸­ï¼Œæ‰€æœ‰ IO éƒ½å¿…é¡»å…ˆç»ç”± VFS å±‚è¿›è¡Œè½¬å‘ã€‚é€šè¿‡ VFS å°†åŒ…æ‹¬ç£ç›˜ã€ç½‘ç»œ Socketã€æ‰“å°æœºã€ç®¡é“ç­‰èµ„æºå…¨éƒ¨å°è£…æˆç»Ÿä¸€çš„æ¥å£ã€‚
åŸºç¡€ç»“æ„ VFS è‡ªé¡¶å‘ä¸‹ä½¿ç”¨å››ä¸ªæ•°æ®ç»“æ„æ¥æè¿°æ–‡ä»¶ï¼š
file: å­˜æ”¾ä¸€ä¸ªæ–‡ä»¶å¯¹è±¡çš„ä¿¡æ¯ã€‚ struct file { union { struct llist_node fu_llist; struct rcu_head fu_rcuhead; } f_u; struct path f_path; struct inode *f_inode; /* cached value */ const struct file_operations *f_op; struct mutex f_pos_lock; loff_t f_pos; } dentry: å­˜æ”¾ç›®å½•é¡¹å’Œå…¶ä¸‹çš„æ–‡ä»¶é“¾æ¥ä¿¡æ¯ã€‚ struct dentry { unsigned int d_flags; seqcount_t d_seq; struct hlist_bl_node d_hash; /* å“ˆå¸Œé“¾è¡¨ */ struct dentry *d_parent; /* çˆ¶ç›®å½•é¡¹ */ struct qstr d_name; /* ç›®å½•å */ struct inode *d_inode; /* å¯¹åº”çš„ç´¢å¼•èŠ‚ç‚¹ */ unsigned char d_iname[DNAME_INLINE_LEN]; /* small names */ struct lockref d_lockref; /* per-dentry lock and refcount */ const struct dentry_operations *d_op; /* dentryæ“ä½œ */ struct super_block *d_sb; /* æ–‡ä»¶çš„è¶…çº§å—å¯¹è±¡ */ unsigned long d_time; void *d_fsdata; struct list_head d_lru; /* LRU list */ struct list_head d_child; /* child of parent list */ struct list_head d_subdirs; /* our children */ union { struct hlist_node d_alias; /* inode alias list */ struct rcu_head d_rcu; } d_u; } inode: ç´¢å¼•èŠ‚ç‚¹å¯¹è±¡ï¼Œå­˜åœ¨å…·ä½“æ–‡ä»¶çš„ä¸€èˆ¬ä¿¡æ¯ï¼Œæ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶çš„å”¯ä¸€æ ‡è¯†ã€‚ struct inode { struct hlist_node i_hash; /* æ•£åˆ—è¡¨ï¼Œç”¨äºå¿«é€ŸæŸ¥æ‰¾inode */ struct list_head i_list; /* ç›¸åŒçŠ¶æ€ç´¢å¼•èŠ‚ç‚¹é“¾è¡¨ */ struct list_head i_sb_list; /* æ–‡ä»¶ç³»ç»Ÿä¸­æ‰€æœ‰èŠ‚ç‚¹é“¾è¡¨ */ struct list_head i_dentry; /* ç›®å½•é¡¹é“¾è¡¨ */ unsigned long i_ino; /* èŠ‚ç‚¹å· */ atomic_t i_count; /* å¼•ç”¨è®¡æ•° */ unsigned int i_nlink; /* ç¡¬é“¾æ¥æ•° */ uid_t i_uid; /* ä½¿ç”¨è€…id */ gid_t i_gid; /* ä½¿ç”¨ç»„id */ struct timespec i_atime; /* æœ€åè®¿é—®æ—¶é—´ */ struct timespec i_mtime; /* æœ€åä¿®æ”¹æ—¶é—´ */ struct timespec i_ctime; /* æœ€åæ”¹å˜æ—¶é—´ */ const struct inode_operations *i_op; /* ç´¢å¼•èŠ‚ç‚¹æ“ä½œå‡½æ•° */ const struct file_operations *i_fop; /* ç¼ºçœçš„ç´¢å¼•èŠ‚ç‚¹æ“ä½œ */ struct super_block *i_sb; /* ç›¸å…³çš„è¶…çº§å— */ struct address_space *i_mapping; /* ç›¸å…³çš„åœ°å€æ˜ å°„ */ struct address_space i_data; /* è®¾å¤‡åœ°å€æ˜ å°„ */ unsigned int i_flags; /* æ–‡ä»¶ç³»ç»Ÿæ ‡å¿— */ void *i_private; /* fs ç§æœ‰æŒ‡é’ˆ */ unsigned long i_state; }; superblock: è¶…çº§å—å¯¹è±¡ï¼Œè®°å½•è¯¥æ–‡ä»¶ç³»ç»Ÿçš„æ•´ä½“ä¿¡æ¯ã€‚åœ¨æ–‡ä»¶ç³»ç»Ÿå®‰è£…æ—¶å»ºç«‹ï¼Œåœ¨æ–‡ä»¶ç³»ç»Ÿå¸è½½æ—¶åˆ é™¤ã€‚ é“¾æ¥ ç¡¬é“¾æ¥ VS è½¯é“¾æ¥:
"><meta name=description content="åœ¨ Linux ä¸­ï¼Œæ‰€æœ‰å¤–éƒ¨èµ„æºéƒ½ä»¥æ–‡ä»¶å½¢å¼ä½œä¸ºä¸€ä¸ªæŠ½è±¡è§†å›¾ï¼Œå¹¶æä¾›ä¸€å¥—ç»Ÿä¸€çš„æ¥å£ç»™åº”ç”¨ç¨‹åºè°ƒç”¨ã€‚æœ¬æ–‡å°†ä»¥å®è§‚è§†è§’è¯•å›¾é˜è¿° Linux ä¸­å…³äºæ–‡ä»¶ IO çš„æ•´ä¸ªè°ƒç”¨è„‰ç»œã€‚
VFS åœ¨ Linux ä¸­ï¼Œæ‰€æœ‰ IO éƒ½å¿…é¡»å…ˆç»ç”± VFS å±‚è¿›è¡Œè½¬å‘ã€‚é€šè¿‡ VFS å°†åŒ…æ‹¬ç£ç›˜ã€ç½‘ç»œ Socketã€æ‰“å°æœºã€ç®¡é“ç­‰èµ„æºå…¨éƒ¨å°è£…æˆç»Ÿä¸€çš„æ¥å£ã€‚
åŸºç¡€ç»“æ„ VFS è‡ªé¡¶å‘ä¸‹ä½¿ç”¨å››ä¸ªæ•°æ®ç»“æ„æ¥æè¿°æ–‡ä»¶ï¼š
file: å­˜æ”¾ä¸€ä¸ªæ–‡ä»¶å¯¹è±¡çš„ä¿¡æ¯ã€‚ struct file { union { struct llist_node fu_llist; struct rcu_head fu_rcuhead; } f_u; struct path f_path; struct inode *f_inode; /* cached value */ const struct file_operations *f_op; struct mutex f_pos_lock; loff_t f_pos; } dentry: å­˜æ”¾ç›®å½•é¡¹å’Œå…¶ä¸‹çš„æ–‡ä»¶é“¾æ¥ä¿¡æ¯ã€‚ struct dentry { unsigned int d_flags; seqcount_t d_seq; struct hlist_bl_node d_hash; /* å“ˆå¸Œé“¾è¡¨ */ struct dentry *d_parent; /* çˆ¶ç›®å½•é¡¹ */ struct qstr d_name; /* ç›®å½•å */ struct inode *d_inode; /* å¯¹åº”çš„ç´¢å¼•èŠ‚ç‚¹ */ unsigned char d_iname[DNAME_INLINE_LEN]; /* small names */ struct lockref d_lockref; /* per-dentry lock and refcount */ const struct dentry_operations *d_op; /* dentryæ“ä½œ */ struct super_block *d_sb; /* æ–‡ä»¶çš„è¶…çº§å—å¯¹è±¡ */ unsigned long d_time; void *d_fsdata; struct list_head d_lru; /* LRU list */ struct list_head d_child; /* child of parent list */ struct list_head d_subdirs; /* our children */ union { struct hlist_node d_alias; /* inode alias list */ struct rcu_head d_rcu; } d_u; } inode: ç´¢å¼•èŠ‚ç‚¹å¯¹è±¡ï¼Œå­˜åœ¨å…·ä½“æ–‡ä»¶çš„ä¸€èˆ¬ä¿¡æ¯ï¼Œæ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶çš„å”¯ä¸€æ ‡è¯†ã€‚ struct inode { struct hlist_node i_hash; /* æ•£åˆ—è¡¨ï¼Œç”¨äºå¿«é€ŸæŸ¥æ‰¾inode */ struct list_head i_list; /* ç›¸åŒçŠ¶æ€ç´¢å¼•èŠ‚ç‚¹é“¾è¡¨ */ struct list_head i_sb_list; /* æ–‡ä»¶ç³»ç»Ÿä¸­æ‰€æœ‰èŠ‚ç‚¹é“¾è¡¨ */ struct list_head i_dentry; /* ç›®å½•é¡¹é“¾è¡¨ */ unsigned long i_ino; /* èŠ‚ç‚¹å· */ atomic_t i_count; /* å¼•ç”¨è®¡æ•° */ unsigned int i_nlink; /* ç¡¬é“¾æ¥æ•° */ uid_t i_uid; /* ä½¿ç”¨è€…id */ gid_t i_gid; /* ä½¿ç”¨ç»„id */ struct timespec i_atime; /* æœ€åè®¿é—®æ—¶é—´ */ struct timespec i_mtime; /* æœ€åä¿®æ”¹æ—¶é—´ */ struct timespec i_ctime; /* æœ€åæ”¹å˜æ—¶é—´ */ const struct inode_operations *i_op; /* ç´¢å¼•èŠ‚ç‚¹æ“ä½œå‡½æ•° */ const struct file_operations *i_fop; /* ç¼ºçœçš„ç´¢å¼•èŠ‚ç‚¹æ“ä½œ */ struct super_block *i_sb; /* ç›¸å…³çš„è¶…çº§å— */ struct address_space *i_mapping; /* ç›¸å…³çš„åœ°å€æ˜ å°„ */ struct address_space i_data; /* è®¾å¤‡åœ°å€æ˜ å°„ */ unsigned int i_flags; /* æ–‡ä»¶ç³»ç»Ÿæ ‡å¿— */ void *i_private; /* fs ç§æœ‰æŒ‡é’ˆ */ unsigned long i_state; }; superblock: è¶…çº§å—å¯¹è±¡ï¼Œè®°å½•è¯¥æ–‡ä»¶ç³»ç»Ÿçš„æ•´ä½“ä¿¡æ¯ã€‚åœ¨æ–‡ä»¶ç³»ç»Ÿå®‰è£…æ—¶å»ºç«‹ï¼Œåœ¨æ–‡ä»¶ç³»ç»Ÿå¸è½½æ—¶åˆ é™¤ã€‚ é“¾æ¥ ç¡¬é“¾æ¥ VS è½¯é“¾æ¥:
"><meta property="og:locale" content="cn"><meta property="og:image" content="/logo.png"><style>:root{--bg-color:#ffffff;--text-color:#000000;--link-color:#000000;--border-color:#482936;--secondary-text:#666666;--code-bg:#f6f8fa;--blockquote-color:#57606a;--blockquote-border:#d0d7de;--disqus-bg:white}[data-theme=dark]{--bg-color:#1a1a1a;--text-color:#e0e0e0;--link-color:#b0b0b0;--border-color:#8b5a7a;--secondary-text:#aaaaaa;--code-bg:#2d2d2d;--blockquote-color:#a0a0a0;--blockquote-border:#404040;--disqus-bg:#1a1a1a}body{font-family:bree serif,sans-serif;-webkit-font-smoothing:antialiased;margin:0 20px;background-color:var(--bg-color);color:var(--text-color)}article{max-width:800px;margin-left:auto;margin-right:auto}a{color:var(--link-color);text-decoration:none}a:hover{font-weight:600;text-decoration:underline}.post-ads{margin:50px 0}.markdown-body{font-size:18px;max-width:100%}.markdown-body a{text-decoration:underline;text-decoration-color:var(--link-color)}.markdown-body blockquote{margin:0;padding:0 1em;color:var(--blockquote-color);border-left:.25em solid var(--blockquote-border)}.markdown-body pre{padding:16px;overflow:auto;border-radius:10px;background-color:var(--code-bg)}.markdown-body code{padding:.2em .4em;font-size:85%;background-color:var(--code-bg);border-radius:6px}.markdown-body pre>code{padding:0;font-size:100%;background-color:var(--code-bg);border:0}.Chinese .markdown-body{line-height:200%}.site-date-catalog{font-size:2rem}.header-title{font-size:2rem;font-weight:700;margin-top:32px;font-family:bungee shade,sans-serif}.header-title a{text-decoration:none}.header-subtitle{color:var(--secondary-text)}.header-items{margin:10px 0}.header-item{margin:0 5px}.header-line{width:100%;border-width:2px;border-color:var(--border-color);border-style:solid none none none}.lang-switch{font-weight:600}.theme-toggle{background:0 0;border:none;color:var(--link-color);cursor:pointer;font-weight:600;font-size:inherit;padding:0}.theme-toggle:hover{font-weight:800}#posts-list{min-height:600px}.posts-line{font-size:1.2rem;margin:12px 0}.posts-categories{font-size:.8rem;margin:auto;text-align:center}.posts-category{padding:3px 0;border:var(--text-color)2px solid;border-radius:5px}.site-footer{margin-top:50px}.site-footer-item{margin-right:12px}.post-header{margin-bottom:50px}.post-title{font-size:2rem;font-weight:600}.post-tags{display:inline;font-weight:600;padding:2px 5px;margin-right:6px;border:var(--text-color)2px solid;border-radius:5px}.post-date{font-weight:800;font-style:italic}.post-author{float:right;font-weight:600}.page-content{min-height:60%}.post-content{margin-bottom:50px}.post-content p{hyphens:auto;line-height:1.8;text-justify:ideographic;margin-bottom:1em}.post-content img{max-width:100%;display:block;margin-right:auto;margin-top:6px}.post-content .post-gallery{display:flex;flex-wrap:wrap;gap:6px}.post-content .post-gallery img{margin-right:auto;margin-top:auto;width:calc(50% - 3px)}.related-content{border-width:3px;border-style:solid;border-color:var(--text-color);padding:0 10px;margin-bottom:50px;margin-top:100px}.related-content li{margin:5px 0}.taxonomy-term{font-size:3rem}.gallery-img{text-align:center}.gallery-img span{text-align:center}.gallery-img-desc{font-size:.8em;font-weight:800}#disqus_thread{position:relative}#disqus_thread:after{content:"";display:block;height:55px;width:100%;position:absolute;bottom:0;background:var(--disqus-bg)}@media screen and (max-width:600px){.header-title,.header-subtitle,.header-items{}.posts-line{font-size:16px}.markdown-body{font-size:16px}.post-title{font-size:2rem}.post-content p{letter-spacing:.05em}.post-content .post-gallery img{width:100%}}@media screen and (max-width:48em){.posts-category{display:none}}</style><style>.container,.container-fluid{margin-right:auto;margin-left:auto}.container-fluid{padding-right:2rem;padding-left:2rem}.row{box-sizing:border-box;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:0;-ms-flex:0 1 auto;flex:initial;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-right:-.5rem;margin-left:-.5rem}.row.reverse{-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.col.reverse{-webkit-box-orient:vertical;-webkit-box-direction:reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse}.col-xs,.col-xs-1,.col-xs-10,.col-xs-11,.col-xs-12,.col-xs-2,.col-xs-3,.col-xs-4,.col-xs-5,.col-xs-6,.col-xs-7,.col-xs-8,.col-xs-9,.col-xs-offset-0,.col-xs-offset-1,.col-xs-offset-10,.col-xs-offset-11,.col-xs-offset-12,.col-xs-offset-2,.col-xs-offset-3,.col-xs-offset-4,.col-xs-offset-5,.col-xs-offset-6,.col-xs-offset-7,.col-xs-offset-8,.col-xs-offset-9{box-sizing:border-box;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:none;padding-right:.5rem;padding-left:.5rem}.col-xs{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:0;flex-basis:0;max-width:100%}.col-xs-1{-ms-flex-preferred-size:8.33333333%;flex-basis:8.33333333%;max-width:8.33333333%}.col-xs-2{-ms-flex-preferred-size:16.66666667%;flex-basis:16.66666667%;max-width:16.66666667%}.col-xs-3{-ms-flex-preferred-size:25%;flex-basis:25%;max-width:25%}.col-xs-4{-ms-flex-preferred-size:33.33333333%;flex-basis:33.33333333%;max-width:33.33333333%}.col-xs-5{-ms-flex-preferred-size:41.66666667%;flex-basis:41.66666667%;max-width:41.66666667%}.col-xs-6{-ms-flex-preferred-size:50%;flex-basis:50%;max-width:50%}.col-xs-7{-ms-flex-preferred-size:58.33333333%;flex-basis:58.33333333%;max-width:58.33333333%}.col-xs-8{-ms-flex-preferred-size:66.66666667%;flex-basis:66.66666667%;max-width:66.66666667%}.col-xs-9{-ms-flex-preferred-size:75%;flex-basis:75%;max-width:75%}.col-xs-10{-ms-flex-preferred-size:83.33333333%;flex-basis:83.33333333%;max-width:83.33333333%}.col-xs-11{-ms-flex-preferred-size:91.66666667%;flex-basis:91.66666667%;max-width:91.66666667%}.col-xs-12{-ms-flex-preferred-size:100%;flex-basis:100%;max-width:100%}.col-xs-offset-0{margin-left:0}.col-xs-offset-1{margin-left:8.33333333%}.col-xs-offset-2{margin-left:16.66666667%}.col-xs-offset-3{margin-left:25%}.col-xs-offset-4{margin-left:33.33333333%}.col-xs-offset-5{margin-left:41.66666667%}.col-xs-offset-6{margin-left:50%}.col-xs-offset-7{margin-left:58.33333333%}.col-xs-offset-8{margin-left:66.66666667%}.col-xs-offset-9{margin-left:75%}.col-xs-offset-10{margin-left:83.33333333%}.col-xs-offset-11{margin-left:91.66666667%}.start-xs{-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;text-align:start}.center-xs{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;text-align:center}.end-xs{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;text-align:end}.top-xs{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.middle-xs{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.bottom-xs{-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}.around-xs{-ms-flex-pack:distribute;justify-content:space-around}.between-xs{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.first-xs{-webkit-box-ordinal-group:0;-ms-flex-order:-1;order:-1}.last-xs{-webkit-box-ordinal-group:2;-ms-flex-order:1;order:1}@media only screen and (min-width:48em){.container{width:49rem}.col-sm,.col-sm-1,.col-sm-10,.col-sm-11,.col-sm-12,.col-sm-2,.col-sm-3,.col-sm-4,.col-sm-5,.col-sm-6,.col-sm-7,.col-sm-8,.col-sm-9,.col-sm-offset-0,.col-sm-offset-1,.col-sm-offset-10,.col-sm-offset-11,.col-sm-offset-12,.col-sm-offset-2,.col-sm-offset-3,.col-sm-offset-4,.col-sm-offset-5,.col-sm-offset-6,.col-sm-offset-7,.col-sm-offset-8,.col-sm-offset-9{box-sizing:border-box;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:none;padding-right:.5rem;padding-left:.5rem}.col-sm{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:0;flex-basis:0;max-width:100%}.col-sm-1{-ms-flex-preferred-size:8.33333333%;flex-basis:8.33333333%;max-width:8.33333333%}.col-sm-2{-ms-flex-preferred-size:16.66666667%;flex-basis:16.66666667%;max-width:16.66666667%}.col-sm-3{-ms-flex-preferred-size:25%;flex-basis:25%;max-width:25%}.col-sm-4{-ms-flex-preferred-size:33.33333333%;flex-basis:33.33333333%;max-width:33.33333333%}.col-sm-5{-ms-flex-preferred-size:41.66666667%;flex-basis:41.66666667%;max-width:41.66666667%}.col-sm-6{-ms-flex-preferred-size:50%;flex-basis:50%;max-width:50%}.col-sm-7{-ms-flex-preferred-size:58.33333333%;flex-basis:58.33333333%;max-width:58.33333333%}.col-sm-8{-ms-flex-preferred-size:66.66666667%;flex-basis:66.66666667%;max-width:66.66666667%}.col-sm-9{-ms-flex-preferred-size:75%;flex-basis:75%;max-width:75%}.col-sm-10{-ms-flex-preferred-size:83.33333333%;flex-basis:83.33333333%;max-width:83.33333333%}.col-sm-11{-ms-flex-preferred-size:91.66666667%;flex-basis:91.66666667%;max-width:91.66666667%}.col-sm-12{-ms-flex-preferred-size:100%;flex-basis:100%;max-width:100%}.col-sm-offset-0{margin-left:0}.col-sm-offset-1{margin-left:8.33333333%}.col-sm-offset-2{margin-left:16.66666667%}.col-sm-offset-3{margin-left:25%}.col-sm-offset-4{margin-left:33.33333333%}.col-sm-offset-5{margin-left:41.66666667%}.col-sm-offset-6{margin-left:50%}.col-sm-offset-7{margin-left:58.33333333%}.col-sm-offset-8{margin-left:66.66666667%}.col-sm-offset-9{margin-left:75%}.col-sm-offset-10{margin-left:83.33333333%}.col-sm-offset-11{margin-left:91.66666667%}.start-sm{-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;text-align:start}.center-sm{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;text-align:center}.end-sm{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;text-align:end}.top-sm{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.middle-sm{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.bottom-sm{-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}.around-sm{-ms-flex-pack:distribute;justify-content:space-around}.between-sm{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.first-sm{-webkit-box-ordinal-group:0;-ms-flex-order:-1;order:-1}.last-sm{-webkit-box-ordinal-group:2;-ms-flex-order:1;order:1}}@media only screen and (min-width:64em){.container{width:65rem}.col-md,.col-md-1,.col-md-10,.col-md-11,.col-md-12,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9,.col-md-offset-0,.col-md-offset-1,.col-md-offset-10,.col-md-offset-11,.col-md-offset-12,.col-md-offset-2,.col-md-offset-3,.col-md-offset-4,.col-md-offset-5,.col-md-offset-6,.col-md-offset-7,.col-md-offset-8,.col-md-offset-9{box-sizing:border-box;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:none;padding-right:.5rem;padding-left:.5rem}.col-md{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:0;flex-basis:0;max-width:100%}.col-md-1{-ms-flex-preferred-size:8.33333333%;flex-basis:8.33333333%;max-width:8.33333333%}.col-md-2{-ms-flex-preferred-size:16.66666667%;flex-basis:16.66666667%;max-width:16.66666667%}.col-md-3{-ms-flex-preferred-size:25%;flex-basis:25%;max-width:25%}.col-md-4{-ms-flex-preferred-size:33.33333333%;flex-basis:33.33333333%;max-width:33.33333333%}.col-md-5{-ms-flex-preferred-size:41.66666667%;flex-basis:41.66666667%;max-width:41.66666667%}.col-md-6{-ms-flex-preferred-size:50%;flex-basis:50%;max-width:50%}.col-md-7{-ms-flex-preferred-size:58.33333333%;flex-basis:58.33333333%;max-width:58.33333333%}.col-md-8{-ms-flex-preferred-size:66.66666667%;flex-basis:66.66666667%;max-width:66.66666667%}.col-md-9{-ms-flex-preferred-size:75%;flex-basis:75%;max-width:75%}.col-md-10{-ms-flex-preferred-size:83.33333333%;flex-basis:83.33333333%;max-width:83.33333333%}.col-md-11{-ms-flex-preferred-size:91.66666667%;flex-basis:91.66666667%;max-width:91.66666667%}.col-md-12{-ms-flex-preferred-size:100%;flex-basis:100%;max-width:100%}.col-md-offset-0{margin-left:0}.col-md-offset-1{margin-left:8.33333333%}.col-md-offset-2{margin-left:16.66666667%}.col-md-offset-3{margin-left:25%}.col-md-offset-4{margin-left:33.33333333%}.col-md-offset-5{margin-left:41.66666667%}.col-md-offset-6{margin-left:50%}.col-md-offset-7{margin-left:58.33333333%}.col-md-offset-8{margin-left:66.66666667%}.col-md-offset-9{margin-left:75%}.col-md-offset-10{margin-left:83.33333333%}.col-md-offset-11{margin-left:91.66666667%}.start-md{-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;text-align:start}.center-md{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;text-align:center}.end-md{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;text-align:end}.top-md{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.middle-md{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.bottom-md{-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}.around-md{-ms-flex-pack:distribute;justify-content:space-around}.between-md{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.first-md{-webkit-box-ordinal-group:0;-ms-flex-order:-1;order:-1}.last-md{-webkit-box-ordinal-group:2;-ms-flex-order:1;order:1}}@media only screen and (min-width:75em){.container{width:76rem}.col-lg,.col-lg-1,.col-lg-10,.col-lg-11,.col-lg-12,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9,.col-lg-offset-0,.col-lg-offset-1,.col-lg-offset-10,.col-lg-offset-11,.col-lg-offset-12,.col-lg-offset-2,.col-lg-offset-3,.col-lg-offset-4,.col-lg-offset-5,.col-lg-offset-6,.col-lg-offset-7,.col-lg-offset-8,.col-lg-offset-9{box-sizing:border-box;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:none;padding-right:.5rem;padding-left:.5rem}.col-lg{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:0;flex-basis:0;max-width:100%}.col-lg-1{-ms-flex-preferred-size:8.33333333%;flex-basis:8.33333333%;max-width:8.33333333%}.col-lg-2{-ms-flex-preferred-size:16.66666667%;flex-basis:16.66666667%;max-width:16.66666667%}.col-lg-3{-ms-flex-preferred-size:25%;flex-basis:25%;max-width:25%}.col-lg-4{-ms-flex-preferred-size:33.33333333%;flex-basis:33.33333333%;max-width:33.33333333%}.col-lg-5{-ms-flex-preferred-size:41.66666667%;flex-basis:41.66666667%;max-width:41.66666667%}.col-lg-6{-ms-flex-preferred-size:50%;flex-basis:50%;max-width:50%}.col-lg-7{-ms-flex-preferred-size:58.33333333%;flex-basis:58.33333333%;max-width:58.33333333%}.col-lg-8{-ms-flex-preferred-size:66.66666667%;flex-basis:66.66666667%;max-width:66.66666667%}.col-lg-9{-ms-flex-preferred-size:75%;flex-basis:75%;max-width:75%}.col-lg-10{-ms-flex-preferred-size:83.33333333%;flex-basis:83.33333333%;max-width:83.33333333%}.col-lg-11{-ms-flex-preferred-size:91.66666667%;flex-basis:91.66666667%;max-width:91.66666667%}.col-lg-12{-ms-flex-preferred-size:100%;flex-basis:100%;max-width:100%}.col-lg-offset-0{margin-left:0}.col-lg-offset-1{margin-left:8.33333333%}.col-lg-offset-2{margin-left:16.66666667%}.col-lg-offset-3{margin-left:25%}.col-lg-offset-4{margin-left:33.33333333%}.col-lg-offset-5{margin-left:41.66666667%}.col-lg-offset-6{margin-left:50%}.col-lg-offset-7{margin-left:58.33333333%}.col-lg-offset-8{margin-left:66.66666667%}.col-lg-offset-9{margin-left:75%}.col-lg-offset-10{margin-left:83.33333333%}.col-lg-offset-11{margin-left:91.66666667%}.start-lg{-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;text-align:start}.center-lg{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;text-align:center}.end-lg{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;text-align:end}.top-lg{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.middle-lg{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.bottom-lg{-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}.around-lg{-ms-flex-pack:distribute;justify-content:space-around}.between-lg{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.first-lg{-webkit-box-ordinal-group:0;-ms-flex-order:-1;order:-1}.last-lg{-webkit-box-ordinal-group:2;-ms-flex-order:1;order:1}}</style><link href=https://cdn.jsdelivr.net/gh/joway/blog/index.xml rel=alternate type=application/rss+xml title="Random Thoughts"><link rel=preconnect href=https://fonts.gstatic.com><link href="https://fonts.googleapis.com/css?family=Bree+Serif|Bungee+Shade" rel=stylesheet><script data-cfasync=false>(function(){const o="theme",e={light:"light",dark:"dark",system:"system"};function t(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function n(){return localStorage.getItem(o)}function r(){const s=n();return s&&s!==e.system?s:t()}function s(n){const s=document.documentElement;n===e.system&&(n=t()),n===e.dark?s.setAttribute("data-theme","dark"):s.removeAttribute("data-theme"),i(n)}function i(e){const t=document.getElementById("theme-toggle");t&&(t.textContent=e==="dark"?"â˜€ï¸":"ğŸŒ™")}function a(){i(r())}function c(){const o=n();let i;o?(i=o===e.system?t():o,s(o)):(i=t(),s(e.system))}function l(){const a=n()||e.system;let i;a===e.system?i=t()==="dark"?e.light:e.dark:a===e.dark?i=e.light:i=e.dark,localStorage.setItem(o,i),s(i)}window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",function(){const t=n();(!t||t===e.system)&&s(e.system)}),document.readyState==="loading"?document.addEventListener("DOMContentLoaded",a):a(),window.toggleTheme=l,c()})()</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-53624533-8"></script><script src=https://cdn.jsdelivr.net/gh/joway/homepage/analytics.js></script><article class="post ç®€ä½“ä¸­æ–‡" id=article><div class=row><div class=col-xs-12><div class=site-header><header><div class=header-title><a href=/>Random Thoughts</a></div><div class=header-subtitle>Log something useless, but interesting.</div></header><div class="row end-md header-items"><div class=header-item><a href=https://mailchi.mp/a1a0d59e7a19/joway target=_blank>Subscribe</a></div><div class=header-item><a href=/travel target=_blank>Travel</a></div><div class=header-item><a href=https://joway.io target=_blank>About</a></div><div class=header-item><button id=theme-toggle onclick=toggleTheme() class=theme-toggle>ğŸŒ™</button></div></div><div class=row></div><div class=header-line></div></div><header class=post-header><h1 class=post-title>Linux I/O æ ˆæµ…æ</h1><div class="row post-desc"><div class=col-xs-6><time class=post-date datetime="2019-08-11 00:00:00 UTC">11 Aug 2019</time></div><div class=col-xs-6><div class=post-author><a target=_blank href>@Joway</a></div></div></div></header><div class="post-content markdown-body"><p>åœ¨ Linux ä¸­ï¼Œæ‰€æœ‰å¤–éƒ¨èµ„æºéƒ½ä»¥æ–‡ä»¶å½¢å¼ä½œä¸ºä¸€ä¸ªæŠ½è±¡è§†å›¾ï¼Œå¹¶æä¾›ä¸€å¥—ç»Ÿä¸€çš„æ¥å£ç»™åº”ç”¨ç¨‹åºè°ƒç”¨ã€‚æœ¬æ–‡å°†ä»¥å®è§‚è§†è§’è¯•å›¾é˜è¿° Linux ä¸­å…³äºæ–‡ä»¶ IO çš„æ•´ä¸ªè°ƒç”¨è„‰ç»œã€‚<p><img src=https://ik.imagekit.io/elsetech/blog/images/linux-io/io-stack.png alt><h1 id=vfs>VFS</h1><p>åœ¨ Linux ä¸­ï¼Œæ‰€æœ‰ IO éƒ½å¿…é¡»å…ˆç»ç”± VFS å±‚è¿›è¡Œè½¬å‘ã€‚é€šè¿‡ VFS å°†åŒ…æ‹¬ç£ç›˜ã€ç½‘ç»œ Socketã€æ‰“å°æœºã€ç®¡é“ç­‰èµ„æºå…¨éƒ¨å°è£…æˆç»Ÿä¸€çš„æ¥å£ã€‚<h3 id=åŸºç¡€ç»“æ„>åŸºç¡€ç»“æ„</h3><p>VFS è‡ªé¡¶å‘ä¸‹ä½¿ç”¨å››ä¸ªæ•°æ®ç»“æ„æ¥æè¿°æ–‡ä»¶ï¼š<p><img src=https://ik.imagekit.io/elsetech/blog/images/linux-io/vfs-struct.png alt><ul><li>file: å­˜æ”¾ä¸€ä¸ªæ–‡ä»¶å¯¹è±¡çš„ä¿¡æ¯ã€‚</ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=k>struct</span> <span class=n>file</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>union</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	    <span class=k>struct</span> <span class=n>llist_node</span>           <span class=n>fu_llist</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	    <span class=k>struct</span> <span class=n>rcu_head</span>             <span class=n>fu_rcuhead</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span> <span class=n>f_u</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=k>struct</span> <span class=n>path</span>                     <span class=n>f_path</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=k>struct</span> <span class=n>inode</span>                    <span class=o>*</span><span class=n>f_inode</span><span class=p>;</span>    <span class=cm>/* cached value */</span>
</span></span><span class=line><span class=cl>	<span class=k>const</span> <span class=k>struct</span> <span class=n>file_operations</span>    <span class=o>*</span><span class=n>f_op</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>	
</span></span><span class=line><span class=cl>	<span class=k>struct</span> <span class=n>mutex</span>                    <span class=n>f_pos_lock</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=kt>loff_t</span>                          <span class=n>f_pos</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ul><li>dentry: å­˜æ”¾ç›®å½•é¡¹å’Œå…¶ä¸‹çš„æ–‡ä»¶é“¾æ¥ä¿¡æ¯ã€‚</ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=k>struct</span> <span class=n>dentry</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kt>unsigned</span> <span class=kt>int</span>                   <span class=n>d_flags</span><span class=p>;</span>        
</span></span><span class=line><span class=cl>	<span class=kt>seqcount_t</span>                     <span class=n>d_seq</span><span class=p>;</span>        
</span></span><span class=line><span class=cl>	<span class=k>struct</span> <span class=n>hlist_bl_node</span>           <span class=n>d_hash</span><span class=p>;</span>    <span class=cm>/* å“ˆå¸Œé“¾è¡¨ */</span>
</span></span><span class=line><span class=cl>	<span class=k>struct</span> <span class=n>dentry</span>                  <span class=o>*</span><span class=n>d_parent</span><span class=p>;</span> <span class=cm>/* çˆ¶ç›®å½•é¡¹ */</span>
</span></span><span class=line><span class=cl>	<span class=k>struct</span> <span class=n>qstr</span>                    <span class=n>d_name</span><span class=p>;</span> <span class=cm>/* ç›®å½•å */</span>
</span></span><span class=line><span class=cl>	<span class=k>struct</span> <span class=n>inode</span>                   <span class=o>*</span><span class=n>d_inode</span><span class=p>;</span> <span class=cm>/* å¯¹åº”çš„ç´¢å¼•èŠ‚ç‚¹ */</span>
</span></span><span class=line><span class=cl>	<span class=kt>unsigned</span> <span class=kt>char</span>                  <span class=n>d_iname</span><span class=p>[</span><span class=n>DNAME_INLINE_LEN</span><span class=p>];</span>    <span class=cm>/* small names */</span>
</span></span><span class=line><span class=cl>	
</span></span><span class=line><span class=cl>	<span class=k>struct</span> <span class=n>lockref</span>                 <span class=n>d_lockref</span><span class=p>;</span>    <span class=cm>/* per-dentry lock and refcount */</span>
</span></span><span class=line><span class=cl>	<span class=k>const</span> <span class=k>struct</span> <span class=n>dentry_operations</span> <span class=o>*</span><span class=n>d_op</span><span class=p>;</span>    <span class=cm>/* dentryæ“ä½œ */</span>
</span></span><span class=line><span class=cl>	<span class=k>struct</span> <span class=n>super_block</span>             <span class=o>*</span><span class=n>d_sb</span><span class=p>;</span>    <span class=cm>/* æ–‡ä»¶çš„è¶…çº§å—å¯¹è±¡ */</span>
</span></span><span class=line><span class=cl>	<span class=kt>unsigned</span> <span class=kt>long</span>                  <span class=n>d_time</span><span class=p>;</span>        
</span></span><span class=line><span class=cl>	<span class=kt>void</span>                           <span class=o>*</span><span class=n>d_fsdata</span><span class=p>;</span>            
</span></span><span class=line><span class=cl>	
</span></span><span class=line><span class=cl>	<span class=k>struct</span> <span class=n>list_head</span>               <span class=n>d_lru</span><span class=p>;</span> <span class=cm>/* LRU list */</span>
</span></span><span class=line><span class=cl>	<span class=k>struct</span> <span class=n>list_head</span>               <span class=n>d_child</span><span class=p>;</span> <span class=cm>/* child of parent list */</span>
</span></span><span class=line><span class=cl>	<span class=k>struct</span> <span class=n>list_head</span>               <span class=n>d_subdirs</span><span class=p>;</span> <span class=cm>/* our children */</span>
</span></span><span class=line><span class=cl>	
</span></span><span class=line><span class=cl>	<span class=k>union</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	    <span class=k>struct</span> <span class=n>hlist_node</span>          <span class=n>d_alias</span><span class=p>;</span> <span class=cm>/* inode alias list */</span>
</span></span><span class=line><span class=cl>	    <span class=k>struct</span> <span class=n>rcu_head</span>            <span class=n>d_rcu</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span> <span class=n>d_u</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ul><li>inode: ç´¢å¼•èŠ‚ç‚¹å¯¹è±¡ï¼Œå­˜åœ¨å…·ä½“æ–‡ä»¶çš„ä¸€èˆ¬ä¿¡æ¯ï¼Œæ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶çš„å”¯ä¸€æ ‡è¯†ã€‚</ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=k>struct</span> <span class=n>inode</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>struct</span> <span class=n>hlist_node</span>                <span class=n>i_hash</span><span class=p>;</span> <span class=cm>/* æ•£åˆ—è¡¨ï¼Œç”¨äºå¿«é€ŸæŸ¥æ‰¾inode */</span>
</span></span><span class=line><span class=cl>        <span class=k>struct</span> <span class=n>list_head</span>                 <span class=n>i_list</span><span class=p>;</span> <span class=cm>/* ç›¸åŒçŠ¶æ€ç´¢å¼•èŠ‚ç‚¹é“¾è¡¨ */</span>
</span></span><span class=line><span class=cl>        <span class=k>struct</span> <span class=n>list_head</span>                 <span class=n>i_sb_list</span><span class=p>;</span>  <span class=cm>/* æ–‡ä»¶ç³»ç»Ÿä¸­æ‰€æœ‰èŠ‚ç‚¹é“¾è¡¨  */</span>
</span></span><span class=line><span class=cl>        <span class=k>struct</span> <span class=n>list_head</span>                 <span class=n>i_dentry</span><span class=p>;</span>   <span class=cm>/* ç›®å½•é¡¹é“¾è¡¨ */</span>
</span></span><span class=line><span class=cl>        <span class=kt>unsigned</span> <span class=kt>long</span>                    <span class=n>i_ino</span><span class=p>;</span>      <span class=cm>/* èŠ‚ç‚¹å· */</span>
</span></span><span class=line><span class=cl>        <span class=kt>atomic_t</span>                         <span class=n>i_count</span><span class=p>;</span>    <span class=cm>/* å¼•ç”¨è®¡æ•° */</span>
</span></span><span class=line><span class=cl>        <span class=kt>unsigned</span> <span class=kt>int</span>                     <span class=n>i_nlink</span><span class=p>;</span>    <span class=cm>/* ç¡¬é“¾æ¥æ•° */</span>
</span></span><span class=line><span class=cl>        <span class=kt>uid_t</span>                            <span class=n>i_uid</span><span class=p>;</span>      <span class=cm>/* ä½¿ç”¨è€…id */</span>
</span></span><span class=line><span class=cl>        <span class=kt>gid_t</span>                            <span class=n>i_gid</span><span class=p>;</span>      <span class=cm>/* ä½¿ç”¨ç»„id */</span>
</span></span><span class=line><span class=cl>        <span class=k>struct</span> <span class=n>timespec</span>                  <span class=n>i_atime</span><span class=p>;</span>    <span class=cm>/* æœ€åè®¿é—®æ—¶é—´ */</span>
</span></span><span class=line><span class=cl>        <span class=k>struct</span> <span class=n>timespec</span>                  <span class=n>i_mtime</span><span class=p>;</span>    <span class=cm>/* æœ€åä¿®æ”¹æ—¶é—´ */</span>
</span></span><span class=line><span class=cl>        <span class=k>struct</span> <span class=n>timespec</span>                  <span class=n>i_ctime</span><span class=p>;</span>    <span class=cm>/* æœ€åæ”¹å˜æ—¶é—´ */</span>
</span></span><span class=line><span class=cl>        <span class=k>const</span> <span class=k>struct</span> <span class=n>inode_operations</span>    <span class=o>*</span><span class=n>i_op</span><span class=p>;</span>     <span class=cm>/* ç´¢å¼•èŠ‚ç‚¹æ“ä½œå‡½æ•° */</span>
</span></span><span class=line><span class=cl>        <span class=k>const</span> <span class=k>struct</span> <span class=n>file_operations</span>     <span class=o>*</span><span class=n>i_fop</span><span class=p>;</span>    <span class=cm>/* ç¼ºçœçš„ç´¢å¼•èŠ‚ç‚¹æ“ä½œ */</span>
</span></span><span class=line><span class=cl>        <span class=k>struct</span> <span class=n>super_block</span>               <span class=o>*</span><span class=n>i_sb</span><span class=p>;</span>          <span class=cm>/* ç›¸å…³çš„è¶…çº§å— */</span>
</span></span><span class=line><span class=cl>        <span class=k>struct</span> <span class=n>address_space</span>             <span class=o>*</span><span class=n>i_mapping</span><span class=p>;</span>     <span class=cm>/* ç›¸å…³çš„åœ°å€æ˜ å°„ */</span>
</span></span><span class=line><span class=cl>        <span class=k>struct</span> <span class=n>address_space</span>             <span class=n>i_data</span><span class=p>;</span>         <span class=cm>/* è®¾å¤‡åœ°å€æ˜ å°„ */</span>
</span></span><span class=line><span class=cl>        <span class=kt>unsigned</span> <span class=kt>int</span>                     <span class=n>i_flags</span><span class=p>;</span>        <span class=cm>/* æ–‡ä»¶ç³»ç»Ÿæ ‡å¿— */</span>
</span></span><span class=line><span class=cl>        <span class=kt>void</span>                             <span class=o>*</span><span class=n>i_private</span><span class=p>;</span> <span class=cm>/* fs ç§æœ‰æŒ‡é’ˆ */</span>
</span></span><span class=line><span class=cl>        <span class=kt>unsigned</span> <span class=kt>long</span>                    <span class=n>i_state</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></div><ul><li>superblock: è¶…çº§å—å¯¹è±¡ï¼Œè®°å½•è¯¥æ–‡ä»¶ç³»ç»Ÿçš„æ•´ä½“ä¿¡æ¯ã€‚åœ¨æ–‡ä»¶ç³»ç»Ÿå®‰è£…æ—¶å»ºç«‹ï¼Œåœ¨æ–‡ä»¶ç³»ç»Ÿå¸è½½æ—¶åˆ é™¤ã€‚</ul><h3 id=é“¾æ¥>é“¾æ¥</h3><p>ç¡¬é“¾æ¥ VS è½¯é“¾æ¥:<ul><li>ç¡¬é“¾æ¥ä¸ºç›®æ ‡æ–‡ä»¶åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ dentryï¼Œå¹¶å°† dentry å†™å…¥çˆ¶ç›®å½•çš„æ•°æ®ä¸­ã€‚<li>è½¯é“¾æ¥åˆ›å»ºäº†å…¨æ–°çš„æ–‡ä»¶ï¼Œåªä¸è¿‡å®ƒçš„æ•°æ®ä¿å­˜çš„æ˜¯å¦ä¸€ä¸ªæ–‡ä»¶çš„è·¯å¾„ï¼Œæ‰€ä»¥å®ƒæœ‰ä¸€ä¸ªå…¨æ–°çš„ inodeã€‚</ul><p>ç¡¬é“¾æ¥å­˜åœ¨çš„æ–‡ä»¶å¿…é¡»å®é™…å­˜åœ¨ï¼Œè€Œè½¯é“¾æ¥æ— æ‰€è°“ç›®æ ‡æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚<p>å¦‚æœåˆ é™¤äº†åŸå§‹æ–‡ä»¶çš„è¯ï¼Œè½¯é“¾æ¥ä¼šç›´æ¥ç”Ÿæ•ˆï¼Œä½†æ˜¯ç¡¬é“¾æ¥ä¾æ—§å­˜åœ¨ï¼Œå› ä¸º inode çš„è®¡æ•°å¹¶æ²¡æœ‰å˜æˆ0ï¼Œæ‰€ä»¥å¯¹äºç¡¬é“¾æ¥è€Œè¨€ï¼Œäº‹å®ä¸ŠåŸå§‹æ–‡ä»¶å¹¶æ²¡æœ‰åˆ é™¤ã€‚<p><img src=https://ik.imagekit.io/elsetech/blog/images/linux-io/link.png alt><h3 id=page-cache>Page Cache</h3><p>å½“ VFS è¯»å–çš„ Page ä¸åœ¨ Cache ä¸­æ—¶ï¼Œå…ˆä»å¤–å­˜è¯»å–æ•°æ®å¹¶ç¼“å­˜è¿› Cacheï¼Œå†è¿”å›ã€‚ä¹‹åå½“å†è¯»å–åŒæ ·çš„ Page æ—¶ï¼Œä¼šå…ˆæ£€æŸ¥ Page Cacheï¼Œå¦‚æœå·²ç»å­˜åœ¨ï¼Œä¾¿ä¸ä¼šå†è§¦å‘ä¸‹å±‚ IOã€‚<p>å½“ VFS è¯•å›¾å†™å…¥ Page æ—¶ï¼Œé™¤äº†å†™å…¥å¤–å­˜ä»¥å¤–ï¼Œä¹Ÿä¼šå¾€ Cache ä¸­å†™å…¥æ–°é¡µã€‚ä»è€Œä½¿å¾—å¯¹æ–°å†™å…¥çš„é¡µçš„è¯»å–å¯ä»¥ä¸è§¦å‘å®é™…å¤–å­˜IOã€‚æ­£æ˜¯ç”±äºè¿™ç§æ€§è´¨ï¼Œä½¿å¾—æ¶ˆæ¯é˜Ÿåˆ—è¿™ç±»è¯»å†™éƒ½é›†ä¸­åœ¨æ–°æ•°æ®ä¸Šçš„åº”ç”¨ï¼Œå³ä¾¿è¿è¡Œåœ¨ HDD ä¸Šä¹Ÿèƒ½å¤Ÿæœ‰æƒŠäººçš„è¯»å–æ€§èƒ½ã€‚<h3 id=å½“ç½‘ç»œå­˜å‚¨é‡ä¸Š-page-cache>å½“ç½‘ç»œå­˜å‚¨é‡ä¸Š Page Cache</h3><p>ä» IO å±‚æ¬¡å›¾ä¸­æˆ‘ä»¬å¯ä»¥å‘ç°ï¼ŒPage Cache å®ç°åœ¨ VFS å±‚ï¼Œå½“è¯»å†™éƒ½åœ¨æœ¬åœ°æ—¶ï¼Œçš„ç¡®ä¸ä¼šå‡ºç°é—®é¢˜ã€‚ä½†å½“ä½¿ç”¨ NFS è¿™ç±»ç½‘ç»œå­˜å‚¨æ—¶ï¼Œè¿œç¨‹è¿›è¡Œçš„å†™æ“ä½œå¹¶ä¸èƒ½åŒæ­¥ç»™æœ¬åœ°ï¼Œä»è€Œå¯¼è‡´ Cache æ— æ³•è¢«åŠæ—¶åœ° invalidateï¼Œå¯¼è‡´è¯»çš„è¿˜æ˜¯è€çš„æ•°æ®ã€‚å¯¹äºè¿™ç§æƒ…å†µå¯ä»¥ï¼š<ol><li>åœ¨ NFS å®¢æˆ·ç«¯å¤„è®¾ç½®ä¸ç¼“å­˜æ–‡ä»¶<li>è°ƒä½ç›®å½•å±æ€§ç¼“å­˜çš„æœ€å¤§æ—¶é—´ acdirmax</ol><p>ä½†å¦‚æœå­˜å‚¨çš„æ˜¯ä¸å˜çš„æ•°æ®ï¼Œä¾‹å¦‚å½’æ¡£çš„æ—¥å¿—è¿™ç±»ï¼Œåœ¨è¿›è¡Œæ•°æ®åˆ†ææ—¶ï¼Œä¹Ÿèƒ½å¤Ÿå……åˆ†åˆ©ç”¨ Page Cache æä¾›çš„ç¼“å­˜ä¼˜åŠ¿ã€‚<h3 id=ç›´æ¥-io>ç›´æ¥ IO</h3><p>è®¸å¤šåº”ç”¨è‡ªèº«å·²ç»å®ç°äº†ç¼“å­˜ç­–ç•¥ï¼Œæ­¤æ—¶æ“ä½œç³»ç»Ÿè‡ªå¸¦çš„ Page Cache å¯èƒ½ä¼šæˆäº†å†—ä½™ã€‚é€šè¿‡åœ¨æ‰“å¼€æ–‡ä»¶æ—¶å€™è®¾ç½® O_DIRECT å¯ä»¥ç»•è¿‡ Page Cacheï¼Œç›´æ¥æ“ä½œæ–‡ä»¶ã€‚<p>ç›´æ¥ IO ç›¸æ¯”ä¸é»˜è®¤æ–¹å¼å‡å°‘äº†å†…å­˜æ•°æ®æ‹·è´æ¬¡æ•°ï¼Œé™ä½äº†å¯¹ CPU å’Œå†…å­˜å¸¦å®½çš„ä½¿ç”¨ï¼Œåœ¨æ•°æ®é‡å·¨å¤§çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥å¤§å¤§æå‡æ€§èƒ½ã€‚<h1 id=æ–‡ä»¶ç³»ç»Ÿ>æ–‡ä»¶ç³»ç»Ÿ</h1><p>æ–‡ä»¶ç³»ç»Ÿæ˜¯ä¸€ç§å­˜å‚¨å’Œç»„ç»‡æ•°æ®çš„æ–¹æ³•ï¼Œä½¿å¾—ç”¨æˆ·å¯¹æ–‡ä»¶çš„è®¿é—®ã€æŸ¥æ‰¾ã€ç®¡ç†å˜å¾—æ›´åŠ å®¹æ˜“ã€‚é€šè¿‡æ–‡ä»¶ç³»ç»Ÿè¿™ä¸€å±‚æŠ½è±¡ï¼Œéšè—äº†ç›´æ¥ç®¡ç†å¤–å­˜çš„å¤æ‚æ€§ã€‚<p>ä¸‹å›¾å±•ç¤ºäº†è¯»å–æ–‡ä»¶ /var/log/messages çš„å®Œæ•´è¿‡ç¨‹ï¼š<p><img src=https://ik.imagekit.io/elsetech/blog/images/linux-io/writes.png alt><p>ç›®å‰äººä»¬å¸¸ç”¨é€šç”¨æ–‡ä»¶ç³»ç»Ÿæœ‰ ext4 å’Œ xfsã€‚è€Œåœ¨è¯¸å¤šç»†åˆ†é¢†åŸŸï¼Œé’ˆå¯¹ä¸åŒåœºæ™¯æœ‰éå¸¸å¤šçš„æ–°æ–‡ä»¶ç³»ç»Ÿåœ¨è¿‘äº›å¹´è¯ç”Ÿã€‚ä¾‹å¦‚å¯¹äºæµ·é‡å°æ–‡ä»¶ï¼ˆå¸¸è§çš„å›¾ç‰‡ã€é™æ€èµ„æºï¼‰çš„å­˜å‚¨ï¼Œæœ‰ FastDFS ï¼Œå¯¹ SSD æœ‰ä¸“é—¨ä¼˜åŒ–çš„ JFFS2ã€‚FastDFS é€šè¿‡åœ¨æ–‡ä»¶ç³»ç»Ÿå±‚æŠŠå°æ–‡ä»¶åˆå¹¶æˆå¤§æ–‡ä»¶ï¼Œä»è€Œå‡è½»å¤§é‡å°æ–‡ä»¶å¯¹ç³»ç»Ÿçš„å¼€é”€ã€‚è€Œ JFFS2 é€šè¿‡æŠŠ data å’Œ metadata åœ¨ SSD ä¸Šé¡ºåºå­˜å‚¨ï¼Œå¹¶ä½¿ç”¨ ouf-of-place çš„æ–¹å¼æ›´æ–°ï¼Œæ¥å‡è½»å¯¹ SSD å¯¿å‘½çš„å½±å“ã€‚<h3 id=åˆ†åŒº>åˆ†åŒº</h3><p>æ–‡ä»¶ç³»ç»Ÿè‡ªèº«ä½œä¸ºä¸€ç§è½¯ä»¶å®ç°å¹¶ä¸ä¸€å®š100%å¯é ï¼Œè™½ç„¶ç°ä»£æ–‡ä»¶ç³»ç»Ÿé€šè¿‡æ—¥å¿—ç­‰æŠ€æœ¯å·²ç»æå°‘å‡ºç°ç³»ç»Ÿæ•…éšœï¼Œä½†å³ä¾¿å¦‚æ­¤ï¼Œåœ¨ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿçš„è¿‡ç¨‹ä¸­ï¼Œä¾æ—§ä¼šå‡ºç°æ„å¤–æƒ…å†µä¾‹å¦‚æ–‡ä»¶å†™æ»¡ã€‚é€šè¿‡æ–‡ä»¶ç³»ç»Ÿçš„åˆ†åŒºå¯ä»¥æŠŠæ•…éšœé™åˆ¶åœ¨å±€éƒ¨ä¸Šï¼Œä¸è‡³äºé€ æˆå…¨å±€æ€§å½±å“ã€‚<h2 id=fuse>FUSE</h2><p><img src=https://ik.imagekit.io/elsetech/blog/images/linux-io/fuse.png alt><p>FUSE å…¨ç§° Filesystem in Userspaceï¼Œæ˜¯ä¸€ä¸ªæ”¯æŒç”¨æˆ·åœ¨ç”¨æˆ·æ€ç¼–å†™æ–‡ä»¶ç³»ç»Ÿä»£ç çš„å†…æ ¸æ¨¡å—ï¼Œåœ¨ Linux 2.6.14 åå¼€å§‹æ”¯æŒã€‚ä¸€èˆ¬å¤šç”¨äºåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼Œä¾‹å¦‚ hdfsï¼Œcephï¼Œs3fs ç­‰ã€‚<p>ç”±äº FUSE æå¤§åœ°ç®€åŒ–äº†æ–‡ä»¶ç³»ç»Ÿçš„å¼€å‘é—¨æ§›ï¼Œä½¿å¾—æˆ‘ä»¬ç”¨æ•°åè¡Œä»£ç ä¾¿èƒ½å¼€å‘å‡ºä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œäºæ˜¯å¸‚é¢ä¸Šå‡ºç°äº†å¤§é‡æœ‰è¶£çš„é¡¹ç›®ï¼Œä¾‹å¦‚ <a href=https://en.wikipedia.org/wiki/WikipediaFS>WikipediaFS</a>ï¼ŒMysqlFSï¼Œ<a href=https://github.com/guilload/twitterfs>TwitterFS</a>ï¼ŒGitFSï¼ŒGmailFS ç­‰ã€‚<h3 id=ç»•è¿‡æ–‡ä»¶ç³»ç»Ÿè¯»å†™è£¸è®¾å¤‡>ç»•è¿‡æ–‡ä»¶ç³»ç»Ÿè¯»å†™è£¸è®¾å¤‡</h3><p>å¦‚æœä»”ç»†è§‚å¯Ÿæ–‡ä»¶ç³»ç»Ÿçš„è¯ï¼Œä¼šå‘ç°å®ƒå’Œæ•°æ®åº“çš„éƒ¨åˆ†åŠŸèƒ½ååˆ†ç±»ä¼¼ï¼Œè€Œå¯¹äºæ•°æ®åº“è€Œè¨€çš„è¯ï¼Œç”±äºå…¶æœ¬èº«å°±å®ç°äº†éå¸¸ç²¾ç»†çš„æ•°æ®ç»„ç»‡æ–¹å¼ï¼Œå¦‚æœèƒ½å¤Ÿè¿›ä¸€æ­¥æ¥ç®¡æ‰æ–‡ä»¶ç³»ç»Ÿçš„å·¥ä½œçš„è¯ï¼Œå¯ä»¥æœ‰æ•ˆåœ°é¿å…ä¸¤ä¸ªå±‚çº§ä¸Šä¸€äº›é‡å¤å·¥ä½œçš„äº§ç”Ÿï¼Œä»è€Œæ›´åŠ é«˜æ•ˆåœ°åˆ©ç”¨å­˜å‚¨è®¾å¤‡çš„æ€§èƒ½ã€‚<p>äºæ˜¯è®¸å¤šæ•°æ®åº“å¼€å§‹å°è¯•äº†ç›´æ¥æ“ä½œè£¸è®¾å¤‡çš„æ–¹æ¡ˆï¼Œä¾‹å¦‚ Oracle ä»¥åŠ Mysqlã€‚<h1 id=é€šç”¨å—å±‚>é€šç”¨å—å±‚</h1><p>Linuxä¸‹æœ‰ä¸¤ç§åŸºæœ¬çš„è®¾å¤‡ç±»å‹ï¼Œä¸€ç§æ˜¯å­—ç¬¦è®¾å¤‡ï¼Œå¦å¤–ä¸€ç§æ˜¯å—è®¾å¤‡ã€‚å¦‚æœä¸€ä¸ªè®¾å¤‡åªèƒ½ä»¥å­—ç¬¦æµçš„æ–¹å¼è¢«é¡ºåºè®¿é—®çš„è¯ï¼Œé‚£ä¹ˆå±äºå­—ç¬¦è®¾å¤‡ï¼Œä¾‹å¦‚æ‰“å°æœºã€‚å¦åˆ™åˆ™æ˜¯å—è®¾å¤‡ã€‚Linux é€šè¿‡é€šç”¨å—å±‚å°è£…äº†å„ç±»å—è®¾å¤‡çš„ç¡¬ä»¶ç‰¹æ€§ï¼Œç»™ä¸Šå±‚æä¾›äº†ä¸€ä¸ªé€šç”¨çš„æŠ½è±¡è§†å›¾ã€‚<p>å—ï¼ˆBlockï¼‰æ˜¯åŸºæœ¬çš„æ•°æ®ä¼ è¾“å•å…ƒï¼Œæ‰€ä»¥å—å¤§å°ä¸èƒ½å°äºå­˜å‚¨è®¾å¤‡çš„æœ€å°å¯å¯»å€å•å…ƒï¼ŒåŒæ—¶ç”±äº Page Cache çš„å­˜åœ¨ï¼Œä¸èƒ½å¤§äº Page å¤§å°ã€‚<h1 id=io-è°ƒåº¦å±‚>I/O è°ƒåº¦å±‚</h1><p>I/O è°ƒåº¦å±‚ç®¡ç†å—è®¾å¤‡çš„è¯·æ±‚é˜Ÿåˆ—ï¼Œä¸»è¦è¿›è¡Œåˆå¹¶å’Œæ’åºè¿›æ¥çš„ IO è¯·æ±‚ã€‚åˆå¹¶ IO æ˜¯æŒ‡å¯¹èƒ½å¤Ÿå¹¶æˆé¡ºåºè®¿é—®çš„ IO åˆå¹¶æˆä¸€ä¸ª IOï¼Œä»¥å‡å°‘éšæœºè®¿é—®å¸¦æ¥çš„å½±å“ã€‚IO æ’åºä¸»è¦é’ˆå¯¹ HDD è¿™ç±»é ç£é“å¯»å€çš„è®¾å¤‡ï¼Œé€šè¿‡ IO æ’åºï¼Œå¯ä»¥å‡å°‘å¯»å€æ—¶é—´ã€‚</div><div class="row middle-xs"><div class=col-xs-12></div></div><div class=row><div class=col-xs-12><br><br><p>Subscribeï¼š<a target=_blank href=https://mailchi.mp/a1a0d59e7a19/joway><b>Mailchimp</b></a></p><br><a rel=license href=http://creativecommons.org/licenses/by-nc-nd/4.0/><img alt="Creative Commons License" style=border-width:0 src=https://blog.joway.io/images/cc.png></a></div></div><div style=height:50px></div><div class=post-comments><div id=disqus_thread></div><script>window.addEventListener("load",()=>{(function(){var e=document,t=e.createElement("script");t.src="https://joway.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()})</script><noscript>Please enable JavaScript to view the
<a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div><div class=site-footer></div></div></div></article><script src=https://cdn.jsdelivr.net/gh/joway/blog/js/lazyload.min.js></script><script>var lazyImage=new LazyLoad({container:document.getElementById("article")})</script><script>document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("disqus_thread");if(!e)return;const t=new MutationObserver(function(n){n.forEach(function(){const n=e.getElementsByTagName("iframe");if(n.length>1){const s=n[1];for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(s),t.disconnect()}})});t.observe(e,{childList:!0,subtree:!0})})</script>